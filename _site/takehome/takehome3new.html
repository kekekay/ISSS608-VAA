<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ke Ke">
<meta name="dcterms.date" content="2024-05-18">

<title>ISSS608-VAA - takehome3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ISSS608-VAA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../Hands_on_exercise/Hands_on_ex1/Hands_on_ex1.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands_on_exercise/Hands_on_ex2/Hands_on_ex2.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands_on_exercise/Hands_on_ex3/Hands-on_Ex03_1.html">
 <span class="dropdown-text">Hands-on Exercise 3-1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands_on_exercise/Hands_on_ex3/Hands-on_Ex03_2.html">
 <span class="dropdown-text">Hands-on Exercise 3-2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands_on_exercise/Hands_on_ex4/Hands-on_Ex04_1.html">
 <span class="dropdown-text">Hands-on Exercise 4-1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands_on_exercise/Hands_on_ex4/Hands-on_Ex04_2.html">
 <span class="dropdown-text">Hands-on Exercise 4-2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands_on_exercise/Hands_on_ex4/Hands-on_Ex04_3.html">
 <span class="dropdown-text">Hands-on Exercise 4-3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands_on_exercise/Hands_on_ex5/Hands-on_Ex05.html">
 <span class="dropdown-text">Hands-on Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands_on_exercise/Hands_on_ex6/Hands-on_Ex06.html">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands_on_exercise/Hands_on_ex7/Hands-on_Ex07.html">
 <span class="dropdown-text">Hands-on Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands_on_exercise/Hands_on_ex8/Hands-on_Ex08_1.html">
 <span class="dropdown-text">Hands-on Exercise 8-1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands_on_exercise/Hands_on_ex8/Hands-on_Ex08_2.html">
 <span class="dropdown-text">Hands-on Exercise 8-2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands_on_exercise/Hands_on_ex8/Hands-on_Ex08_3.html">
 <span class="dropdown-text">Hands-on Exercise 8-3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands_on_exercise/Hands_on_ex9/Hands-on_Ex09_1.html">
 <span class="dropdown-text">Hands-on Exercise 9-1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands_on_exercise/Hands_on_ex9/Hands-on_Ex09_2.html">
 <span class="dropdown-text">Hands-on Exercise 9-2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands_on_exercise/Hands_on_ex9/Hands-on_Ex09_3.html">
 <span class="dropdown-text">Hands-on Exercise 9-3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands_on_exercise/Hands_on_ex9/Hands-on_Ex09_4.html">
 <span class="dropdown-text">Hands-on Exercise 9-4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands_on_exercise/Hands_on_ex9/Hands-on_Ex09_5.html">
 <span class="dropdown-text">Hands-on Exercise 9-5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands_on_exercise/Hands_on_ex10/Hands-on_Ex10.html">
 <span class="dropdown-text">Hands-on Exercise 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../inclass/inclass01/inclass01.html">
 <span class="dropdown-text">In-class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../inclass/inclass02/inclass02.html">
 <span class="dropdown-text">In-class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../inclass/inclass04/inclass04.html">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../inclass/inclass05/inclass05.html">
 <span class="dropdown-text">In-class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../inclass/inclass06/inclass06.html">
 <span class="dropdown-text">In-class Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../inclass/inclass06/inclass09.qmd">
 <span class="dropdown-text">In-class Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../inclass/inclass06/inclass10.qmd">
 <span class="dropdown-text">In-class Exercise 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../takehome/takehome1.html">
 <span class="dropdown-text">Part I: Take-home Exercise 1:Singapore Private Residential Market</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../takehome/takehome2.html">
 <span class="dropdown-text">Part II: Take-home Exercise 1: Make-over</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../takehome/takehome3new.html">
 <span class="dropdown-text">Part III: Take-home Exercise 2: Vast Challenge - MC3</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../before_class.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link active" data-scroll-target="#getting-started">Getting Started</a></li>
  <li><a href="#importing-json-file" id="toc-importing-json-file" class="nav-link" data-scroll-target="#importing-json-file"><strong>Importing JSON File</strong></a></li>
  <li><a href="#data-cleaning" id="toc-data-cleaning" class="nav-link" data-scroll-target="#data-cleaning">Data Cleaning</a>
  <ul class="collapse">
  <li><a href="#missing-values" id="toc-missing-values" class="nav-link" data-scroll-target="#missing-values">Missing Values</a></li>
  <li><a href="#check-for-data-types" id="toc-check-for-data-types" class="nav-link" data-scroll-target="#check-for-data-types">Check for data types</a></li>
  <li><a href="#changing-field-name" id="toc-changing-field-name" class="nav-link" data-scroll-target="#changing-field-name"><strong>Changing field name</strong></a></li>
  <li><a href="#split-type-column-into-separate-columns" id="toc-split-type-column-into-separate-columns" class="nav-link" data-scroll-target="#split-type-column-into-separate-columns">Split <em>‘type’</em> column into separate columns</a></li>
  </ul></li>
  <li><a href="#question-3" id="toc-question-3" class="nav-link" data-scroll-target="#question-3">Question 3</a>
  <ul class="collapse">
  <li><a href="#part-1-data-wrangling" id="toc-part-1-data-wrangling" class="nav-link" data-scroll-target="#part-1-data-wrangling">Part 1: Data Wrangling</a></li>
  <li><a href="#part-1-network-graph" id="toc-part-1-network-graph" class="nav-link" data-scroll-target="#part-1-network-graph">Part 1: Network Graph</a></li>
  <li><a href="#part-2-temporal-analysis" id="toc-part-2-temporal-analysis" class="nav-link" data-scroll-target="#part-2-temporal-analysis">Part 2: Temporal Analysis</a></li>
  <li><a href="#part-2-network-graph-by-year" id="toc-part-2-network-graph-by-year" class="nav-link" data-scroll-target="#part-2-network-graph-by-year">Part 2: Network Graph by Year</a></li>
  </ul></li>
  <li><a href="#question-4" id="toc-question-4" class="nav-link" data-scroll-target="#question-4">Question 4</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">takehome3</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Ke Ke </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 18, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">June 26, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<p>In this VAST Challenge project, we analyze the impact of SouthSeafood Express Corp’s illegal fishing on the business network. The first question explores how the network and competing businesses change due to the incident. The second question identifies which companies benefited from SouthSeafood Express Corp’s legal troubles.</p>
<section id="getting-started" class="level2">
<h2 class="anchored" data-anchor-id="getting-started">Getting Started</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidytext, readtext, quanteda, tidyverse, jsonlite, igraph, tidygraph, ggraph, visNetwork, clock, graphlayouts,ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="importing-json-file" class="level2">
<h2 class="anchored" data-anchor-id="importing-json-file"><strong>Importing JSON File</strong></h2>
<p>Direct import of the mc3.json file shows an error message indicating that there’s an invalid character in the JSON text, specifically “NaN”. As “NaN” is not recognised as a valid value, preprocessing of the JSON file to replace “NaN” is required.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the JSON file as text</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>json_text <span class="ot">&lt;-</span> <span class="fu">readLines</span>(<span class="st">"data/mc3.json"</span> ,<span class="at">warn =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace "NaN" with "null"</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>json_text_fixed <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"NaN"</span>, <span class="st">"null"</span>, json_text)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Write the fixed JSON text back to a file</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(json_text_fixed, <span class="st">"data/mc3_fixed.json"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Importing preprocessed mc3_fixed.json file</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mc3_data <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/mc3_fixed.json"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data-cleaning" class="level2">
<h2 class="anchored" data-anchor-id="data-cleaning">Data Cleaning</h2>
<section id="missing-values" class="level3">
<h3 class="anchored" data-anchor-id="missing-values">Missing Values</h3>
<p>Identify the percentage of missing values within the dataset</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate missing value percentages</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>calculate_missing_percentage <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  total_values <span class="ot">&lt;-</span> <span class="fu">nrow</span>(df) <span class="sc">*</span> <span class="fu">ncol</span>(df)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  missing_values <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(df))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  missing_percentage <span class="ot">&lt;-</span> (missing_values <span class="sc">/</span> total_values) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(missing_percentage)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Missing percentage of nodes</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>nodes_missing_percentage <span class="ot">&lt;-</span> <span class="fu">calculate_missing_percentage</span>(mc3_data[[<span class="st">"nodes"</span>]])</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>nodes_missing_percentage</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 35.11952</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>nodes_missing_by_column <span class="ot">&lt;-</span> <span class="fu">sapply</span>(mc3_data[[<span class="st">"nodes"</span>]], <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x)) <span class="sc">/</span> <span class="fu">length</span>(x) <span class="sc">*</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Missing percentage of edges</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>links_missing_percentage <span class="ot">&lt;-</span> <span class="fu">calculate_missing_percentage</span>(mc3_data[[<span class="st">"links"</span>]])</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>links_missing_percentage</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.059973</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>links_missing_by_column <span class="ot">&lt;-</span> <span class="fu">sapply</span>(mc3_data[[<span class="st">"links"</span>]], <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x)) <span class="sc">/</span> <span class="fu">length</span>(x) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>links_missing_by_column</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       start_date              type   _last_edited_by _last_edited_date 
        0.1187069         0.0000000         0.0000000         0.0000000 
      _date_added       _raw_source        _algorithm            source 
        0.0000000         0.0000000         0.0000000         0.0000000 
           target               key          end_date 
        0.0000000         0.0000000        99.5410000 </code></pre>
</div>
</div>
<p>Print missing percentages</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(nodes_missing_percentage)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 35.11952</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(nodes_missing_by_column)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             type           country   ProductServices    PointOfContact 
          0.00000           0.00000          85.34204          85.38334 
        HeadOfOrg     founding_date           revenue  TradeDescription 
         85.35691          85.34204          85.36847          85.34204 
  _last_edited_by _last_edited_date       _date_added       _raw_source 
          0.00000           0.00000           0.00000           0.00000 
       _algorithm                id               dob 
          0.00000           0.00000          14.65796 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(links_missing_percentage)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.059973</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(links_missing_by_column)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       start_date              type   _last_edited_by _last_edited_date 
        0.1187069         0.0000000         0.0000000         0.0000000 
      _date_added       _raw_source        _algorithm            source 
        0.0000000         0.0000000         0.0000000         0.0000000 
           target               key          end_date 
        0.0000000         0.0000000        99.5410000 </code></pre>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Observations:</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Actions:</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<ul>
<li><p><strong>Nodes Data:</strong></p>
<ul>
<li><p><code>ProductServices</code>, <code>PointOfContact</code>, <code>HeadOfOrg</code>, <code>founding_date</code>, <code>revenue</code>, and <code>TradeDescription</code> columns have a high percentage of missing values (around 85%).</p></li>
<li><p>The <code>dob</code> column has about 14.7% missing values.</p></li>
<li><p>Other columns (<code>type</code>, <code>country</code>, <code>_last_edited_by</code>, <code>_last_edited_date</code>, <code>_date_added</code>, <code>_raw_source</code>, <code>_algorithm</code>, and <code>id</code>) have no missing values.</p></li>
</ul></li>
<li><p><strong>Links Data:</strong></p>
<ul>
<li><code>end_date</code> has a very high percentage of missing values (around 99.5%).</li>
</ul></li>
</ul>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<ul>
<li><p>Filled missing values in <code>HeadOfOrg</code> with “Unknown”.</p></li>
<li><p>Filled missing values in <code>revenue</code> with 0.</p></li>
<li><p>Filled missing values in <code>start_date</code> and <code>end_date</code> with “Unknown”.</p></li>
</ul>
</div>
</div>
</div>
<p>Handle missing values</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select crucial columns and fill missing values where appropriate</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>cleaned_nodes <span class="ot">&lt;-</span> mc3_data[[<span class="st">"nodes"</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, type, country, HeadOfOrg, revenue,ProductServices,PointOfContact,founding_date,TradeDescription,dob,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">_last_edited_by</span><span class="st">`</span>, <span class="st">`</span><span class="at">_last_edited_date</span><span class="st">`</span>, <span class="st">`</span><span class="at">_date_added</span><span class="st">`</span>, <span class="st">`</span><span class="at">_raw_source</span><span class="st">`</span>, <span class="st">`</span><span class="at">_algorithm</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">HeadOfOrg =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(HeadOfOrg), <span class="st">"Unknown"</span>, HeadOfOrg),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">revenue =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(revenue), <span class="dv">0</span>, revenue))</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Handle missing values in links</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Select crucial columns and fill missing values where appropriate</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>cleaned_links <span class="ot">&lt;-</span> mc3_data[[<span class="st">"links"</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(key,source, target, type, start_date, end_date, <span class="st">`</span><span class="at">_last_edited_by</span><span class="st">`</span>, <span class="st">`</span><span class="at">_last_edited_date</span><span class="st">`</span>, <span class="st">`</span><span class="at">_date_added</span><span class="st">`</span>, <span class="st">`</span><span class="at">_raw_source</span><span class="st">`</span>, <span class="st">`</span><span class="at">_algorithm</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_date =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(start_date), <span class="st">"Unknown"</span>, start_date),</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_date =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(end_date), <span class="st">"Unknown"</span>, end_date))</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure proper data types</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>cleaned_nodes <span class="ot">&lt;-</span> cleaned_nodes <span class="sc">%&gt;%</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> <span class="fu">as.character</span>(id),</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="fu">as.character</span>(type),</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">country =</span> <span class="fu">as.character</span>(country),</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">HeadOfOrg =</span> <span class="fu">as.character</span>(HeadOfOrg),</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">revenue =</span> <span class="fu">as.numeric</span>(revenue),</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_last_edited_by</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">_last_edited_by</span><span class="st">`</span>),</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_last_edited_date</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">_last_edited_date</span><span class="st">`</span>),</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_date_added</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">_date_added</span><span class="st">`</span>),</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_raw_source</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">_raw_source</span><span class="st">`</span>),</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_algorithm</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">_algorithm</span><span class="st">`</span>)</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>cleaned_links <span class="ot">&lt;-</span> cleaned_links <span class="sc">%&gt;%</span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a> <span class="fu">mutate</span>(</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">source =</span> <span class="fu">as.character</span>(source),</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">target =</span> <span class="fu">as.character</span>(target),</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="fu">as.character</span>(type),</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">start_date =</span> <span class="fu">as.character</span>(start_date),</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">end_date =</span> <span class="fu">as.character</span>(end_date),</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_last_edited_by</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">_last_edited_by</span><span class="st">`</span>),</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_last_edited_date</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">_last_edited_date</span><span class="st">`</span>),</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_date_added</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">_date_added</span><span class="st">`</span>),</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_raw_source</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">_raw_source</span><span class="st">`</span>),</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_algorithm</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">_algorithm</span><span class="st">`</span>)</span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="check-for-data-types" class="level3">
<h3 class="anchored" data-anchor-id="check-for-data-types">Check for data types</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure correct data types for nodes</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>cleaned_nodes <span class="ot">&lt;-</span> cleaned_nodes <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> <span class="fu">as.character</span>(id),</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="fu">as.character</span>(type),</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">country =</span> <span class="fu">as.character</span>(country),</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">HeadOfOrg =</span> <span class="fu">as.character</span>(HeadOfOrg),</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">revenue =</span> <span class="fu">as.numeric</span>(revenue),</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">dob =</span> <span class="fu">as.POSIXct</span>(dob, <span class="at">format=</span><span class="st">"%Y-%m-%dT%H:%M:%S"</span>),</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_last_edited_by</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">_last_edited_by</span><span class="st">`</span>),</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_last_edited_date</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.POSIXct</span>(<span class="st">`</span><span class="at">_last_edited_date</span><span class="st">`</span>, <span class="at">format=</span><span class="st">"%Y-%m-%dT%H:%M:%S"</span>),</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">founding_date=</span><span class="fu">as.POSIXct</span>(founding_date, <span class="at">format=</span><span class="st">"%Y-%m-%dT%H:%M:%S"</span>),</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_date_added</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.POSIXct</span>(<span class="st">`</span><span class="at">_date_added</span><span class="st">`</span>, <span class="at">format=</span><span class="st">"%Y-%m-%dT%H:%M:%S"</span>),</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_raw_source</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">_raw_source</span><span class="st">`</span>),</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_algorithm</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">_algorithm</span><span class="st">`</span>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure correct data types for links</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>cleaned_links <span class="ot">&lt;-</span> cleaned_links <span class="sc">%&gt;%</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a> <span class="fu">mutate</span>(</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">source =</span> <span class="fu">as.character</span>(source),</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">target =</span> <span class="fu">as.character</span>(target),</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="fu">as.character</span>(type),</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">start_date =</span> <span class="fu">as.POSIXct</span>(start_date, <span class="at">format=</span><span class="st">"%Y-%m-%dT%H:%M:%S"</span>),</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">end_date =</span> <span class="fu">as.POSIXct</span>(end_date, <span class="at">format=</span><span class="st">"%Y-%m-%dT%H:%M:%S"</span>),</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_last_edited_by</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">_last_edited_by</span><span class="st">`</span>),</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_last_edited_date</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.POSIXct</span>(<span class="st">`</span><span class="at">_last_edited_date</span><span class="st">`</span>, <span class="at">format=</span><span class="st">"%Y-%m-%dT%H:%M:%S"</span>),</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_date_added</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.POSIXct</span>(<span class="st">`</span><span class="at">_date_added</span><span class="st">`</span>, <span class="at">format=</span><span class="st">"%Y-%m-%dT%H:%M:%S"</span>),</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_raw_source</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">_raw_source</span><span class="st">`</span>),</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_algorithm</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">_algorithm</span><span class="st">`</span>)</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Print cleaned data for inspection</span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(cleaned_nodes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 60,520
Columns: 15
$ id                  &lt;chr&gt; "Abbott, Mcbride and Edwards", "Abbott-Gomez", "Ab…
$ type                &lt;chr&gt; "Entity.Organization.Company", "Entity.Organizatio…
$ country             &lt;chr&gt; "Uziland", "Mawalara", "Uzifrica", "Islavaragon", …
$ HeadOfOrg           &lt;chr&gt; "Émilie-Susan Benoit", "Honoré Lemoine", "Jules La…
$ revenue             &lt;dbl&gt; 5994.73, 71766.67, 0.00, 0.00, 4746.67, 46566.67, …
$ ProductServices     &lt;chr&gt; "Unknown", "Furniture and home accessories", "Food…
$ PointOfContact      &lt;chr&gt; "Rebecca Lewis", "Michael Lopez", "Steven Robertso…
$ founding_date       &lt;dttm&gt; 1954-04-24, 2009-06-12, 2029-12-15, 1972-02-16, 1…
$ TradeDescription    &lt;chr&gt; "Unknown", "Abbott-Gomez is a leading manufacturer…
$ dob                 &lt;dttm&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ `_last_edited_by`   &lt;chr&gt; "Pelagia Alethea Mordoch", "Pelagia Alethea Mordoc…
$ `_last_edited_date` &lt;dttm&gt; 2035-01-01, 2035-01-01, 2035-01-01, 2035-01-01, 2…
$ `_date_added`       &lt;dttm&gt; 2035-01-01, 2035-01-01, 2035-01-01, 2035-01-01, 2…
$ `_raw_source`       &lt;chr&gt; "Existing Corporate Structure Data", "Existing Cor…
$ `_algorithm`        &lt;chr&gt; "Automatic Import", "Automatic Import", "Automatic…</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(cleaned_links)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 75,817
Columns: 11
$ key                 &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ source              &lt;chr&gt; "Avery Inc", "Berger-Hayes", "Bowers Group", "Bowm…
$ target              &lt;chr&gt; "Allen, Nichols and Thompson", "Jensen, Morris and…
$ type                &lt;chr&gt; "Event.Owns.Shareholdership", "Event.Owns.Sharehol…
$ start_date          &lt;dttm&gt; 2016-10-29, 2035-06-03, 2028-11-20, 2024-09-04, 2…
$ end_date            &lt;dttm&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ `_last_edited_by`   &lt;chr&gt; "Pelagia Alethea Mordoch", "Niklaus Oberon", "Pela…
$ `_last_edited_date` &lt;dttm&gt; 2035-01-01, 2035-07-15, 2035-01-01, 2035-01-01, 2…
$ `_date_added`       &lt;dttm&gt; 2035-01-01, 2035-07-15, 2035-01-01, 2035-01-01, 2…
$ `_raw_source`       &lt;chr&gt; "Existing Corporate Structure Data", "Oceanus Corp…
$ `_algorithm`        &lt;chr&gt; "Automatic Import", "Manual Entry", "Automatic Imp…</code></pre>
</div>
</div>
</section>
<section id="changing-field-name" class="level3">
<h3 class="anchored" data-anchor-id="changing-field-name"><strong>Changing field name</strong></h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>cleaned_nodes <span class="ot">&lt;-</span> cleaned_nodes <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"last_edited_by"</span> <span class="ot">=</span> <span class="st">"_last_edited_by"</span>,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">"date_added"</span> <span class="ot">=</span> <span class="st">"_date_added"</span>,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">"last_edited_date"</span> <span class="ot">=</span> <span class="st">"_last_edited_date"</span>,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">"raw_source"</span> <span class="ot">=</span> <span class="st">"_raw_source"</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">"algorithm"</span> <span class="ot">=</span> <span class="st">"_algorithm"</span>) </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>cleaned_links<span class="ot">&lt;-</span> cleaned_links <span class="sc">%&gt;%</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"last_edited_by"</span> <span class="ot">=</span> <span class="st">"_last_edited_by"</span>,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>         <span class="st">"date_added"</span> <span class="ot">=</span> <span class="st">"_date_added"</span>,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>         <span class="st">"last_edited_date"</span> <span class="ot">=</span> <span class="st">"_last_edited_date"</span>,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>         <span class="st">"raw_source"</span> <span class="ot">=</span> <span class="st">"_raw_source"</span>,</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>         <span class="st">"algorithm"</span> <span class="ot">=</span> <span class="st">"_algorithm"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="split-type-column-into-separate-columns" class="level3">
<h3 class="anchored" data-anchor-id="split-type-column-into-separate-columns">Split <em>‘type’</em> column into separate columns</h3>
<p>We are going to tidy the type column by creating two columns “entity2,entity3”.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>word_list1 <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(cleaned_nodes<span class="sc">$</span>type, <span class="st">"</span><span class="sc">\\</span><span class="st">."</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>max_elements1 <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">lengths</span>(word_list1))</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>word_list_padded1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(word_list1, </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span>(x) <span class="fu">c</span>(x, <span class="fu">rep</span>(<span class="cn">NA</span>, max_elements1 <span class="sc">-</span> <span class="fu">length</span>(x))))</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>word_df1 <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, word_list_padded1)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(word_df1) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"entity"</span>, <span class="dv">1</span><span class="sc">:</span>max_elements1)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>word_df1 <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(word_df1) <span class="sc">%&gt;%</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(entity2, entity3)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(word_df1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "tbl_df"     "tbl"        "data.frame"</code></pre>
</div>
</div>
<p>The steps below will be used to split text in type column into two columns</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>word_list <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(cleaned_links<span class="sc">$</span>type, <span class="st">"</span><span class="sc">\\</span><span class="st">."</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>max_elements <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">lengths</span>(word_list))</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>word_list_padded <span class="ot">&lt;-</span> <span class="fu">lapply</span>(word_list, </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span>(x) <span class="fu">c</span>(x, <span class="fu">rep</span>(<span class="cn">NA</span>, max_elements <span class="sc">-</span> <span class="fu">length</span>(x))))</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>word_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, word_list_padded)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(word_df) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"event"</span>, <span class="dv">1</span><span class="sc">:</span>max_elements)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>word_df <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(word_df) <span class="sc">%&gt;%</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(event2, event3)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(word_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "tbl_df"     "tbl"        "data.frame"</code></pre>
</div>
</div>
<p>Since the output above is a matrix, the code chunk above is used to convert word_df into a tibble data.frame.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>cleaned_nodes <span class="ot">&lt;-</span> cleaned_nodes <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(word_df1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>cleaned_links <span class="ot">&lt;-</span> cleaned_links <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(word_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The code chunk above appends the extracted columns back to edges tibble data.frame.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cleaned_nodes, <span class="st">"data/rds/cleaned_nodes.rds"</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cleaned_links, <span class="st">"data/rds/cleaned_links.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>above code write into R&nbsp;<strong>rds</strong>&nbsp;file format.</p>
</section>
</section>
<section id="question-3" class="level2">
<h2 class="anchored" data-anchor-id="question-3">Question 3</h2>
<p>By analyzing the ownership structure, we tracked changes in most influential individuals (VIP) networks over time, identifying key individuals with increasing influence.</p>
<section id="part-1-data-wrangling" class="level3">
<h3 class="anchored" data-anchor-id="part-1-data-wrangling">Part 1: Data Wrangling</h3>
<p>Split the nodes into people and companies, and filter ownership-related edges</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the nodes into people and companies</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>nodes_people <span class="ot">&lt;-</span> cleaned_nodes <span class="sc">%&gt;%</span> <span class="fu">filter</span>(entity2 <span class="sc">==</span> <span class="st">"Person"</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>nodes_company <span class="ot">&lt;-</span> cleaned_nodes <span class="sc">%&gt;%</span> <span class="fu">filter</span>(entity2 <span class="sc">==</span> <span class="st">"Organization"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the links to include only ownership-related edges</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>links_owns <span class="ot">&lt;-</span> cleaned_links <span class="sc">%&gt;%</span> <span class="fu">filter</span>(event2 <span class="sc">==</span> <span class="st">"Owns"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>nodes_people <span class="ot">&lt;-</span> nodes_people <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">'no_owns'</span> <span class="ot">=</span> <span class="fu">sum</span>(links_owns<span class="sc">$</span>source <span class="sc">==</span> id))</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>nodes_people<span class="sc">$</span>no_owns <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(nodes_people<span class="sc">$</span>no_owns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the unique counts of 'no_owns' and their corresponding counts and percentages</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>owns_summary <span class="ot">&lt;-</span> nodes_people <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(no_owns) <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> (count <span class="sc">/</span> <span class="fu">sum</span>(count)) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the summary</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(owns_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 19 × 3
   no_owns count percentage
     &lt;dbl&gt; &lt;int&gt;      &lt;dbl&gt;
 1       0   147    0.285  
 2       1 46370   89.8    
 3       2  4032    7.81   
 4       3   665    1.29   
 5       4   245    0.474  
 6       5    80    0.155  
 7       6    34    0.0658 
 8       7    21    0.0407 
 9       8    11    0.0213 
10       9     7    0.0136 
11      10     2    0.00387
12      11     4    0.00774
13      12     3    0.00581
14      13     2    0.00387
15      15     1    0.00194
16      18     2    0.00387
17      29     1    0.00194
18      91    18    0.0349 
19      92     4    0.00774</code></pre>
</div>
</div>
<p>To define and identify influential people based on an ownership threshold. It filters the nodes to keep only those with a significant number of ownerships</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the threshold for 'influential'</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>vip_threshold <span class="ot">&lt;-</span> <span class="dv">91</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to keep only influential people and select relevant columns</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>vip <span class="ot">&lt;-</span> nodes_people <span class="sc">%&gt;%</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(no_owns <span class="sc">&gt;=</span> vip_threshold) <span class="sc">%&gt;%</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, country, dob, last_edited_date, date_added, no_owns)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the updated vip data frame</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(vip)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 22
Columns: 6
Rowwise: 
$ id               &lt;chr&gt; "Kelsey Ortega", "Joseph Gentry", "Cynthia Anderson",…
$ country          &lt;chr&gt; "n.a.", "n.a.", "n.a.", "n.a.", "n.a.", "n.a.", "n.a.…
$ dob              &lt;dttm&gt; 1974-11-26, 1980-11-08, 1991-07-23, 2013-10-03, 1981…
$ last_edited_date &lt;dttm&gt; 2035-01-01, 2035-01-01, 2035-01-01, 2035-01-01, 2035…
$ date_added       &lt;dttm&gt; 2035-01-01, 2035-01-01, 2035-01-01, 2035-01-01, 2035…
$ no_owns          &lt;dbl&gt; 91, 91, 91, 92, 91, 92, 91, 91, 91, 91, 91, 91, 91, 9…</code></pre>
</div>
</div>
<p>filter the ownership connections to include only those involving these influential individuals</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter links_owns to keep only those connections where the source is in the vip list</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>vip_connections <span class="ot">&lt;-</span> links_owns <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source <span class="sc">%in%</span> vip<span class="sc">$</span>id)<span class="sc">%&gt;%</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source, target,start_date,end_date,last_edited_date, date_added)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the updated vip_connections data frame</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(vip_connections)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 2,006
Columns: 6
$ source           &lt;chr&gt; "Kelsey Ortega", "Kelsey Ortega", "Kelsey Ortega", "K…
$ target           &lt;chr&gt; "Mitchell-Glover", "Anderson, Smith and Weber", "Orr …
$ start_date       &lt;dttm&gt; 2017-08-11, 2028-12-13, 2016-09-18, 2034-12-16, 2032…
$ end_date         &lt;dttm&gt; NA, NA, NA, NA, 2035-07-13, NA, NA, NA, NA, NA, NA, …
$ last_edited_date &lt;dttm&gt; 2035-01-01, 2035-01-01, 2035-01-01, 2035-01-01, 2035…
$ date_added       &lt;dttm&gt; 2035-01-01, 2035-01-01, 2035-01-01, 2035-01-01, 2035…</code></pre>
</div>
</div>
</section>
<section id="part-1-network-graph" class="level3">
<h3 class="anchored" data-anchor-id="part-1-network-graph">Part 1: Network Graph</h3>
<p>Finally, plot the network, highlighting the structure and connections of influential individuals.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create graph from VIP connections</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>g_vip <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> vip_connections, <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify VIPs and Companies</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g_vip)<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g_vip)<span class="sc">$</span>name <span class="sc">%in%</span> nodes_people<span class="sc">$</span>id, <span class="st">"VIP"</span>, <span class="st">"Company"</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Define colors and sizes</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g_vip)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g_vip)<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"VIP"</span>, <span class="st">"blue"</span>, <span class="st">"orange"</span>)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g_vip)<span class="sc">$</span>size <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g_vip)<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"VIP"</span>, <span class="dv">8</span>, <span class="dv">5</span>)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the network</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g_vip, <span class="at">vertex.label =</span> <span class="cn">NA</span>, <span class="at">vertex.size =</span> <span class="fu">V</span>(g_vip)<span class="sc">$</span>size, <span class="at">edge.arrow.size =</span> <span class="fl">0.5</span>, </span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.color =</span> <span class="fu">V</span>(g_vip)<span class="sc">$</span>color, <span class="at">main =</span> <span class="st">"VIP Connections Network"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="takehome3new_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The plot represents the VIP Connections Network, with blue nodes indicating influential VIPs and orange nodes representing companies they own. Directed edges illustrate ownership, pointing from VIPs to companies. This visualization highlights the dense centrality of VIPs, showcasing their extensive control across multiple companies. By examining these connections, we can infer the structure and extent of VIP influence within the network and help FishEye identify influential individuals within the business network, highlighting ownership structures and central figures. By tracking ownership changes over time, FishEye can pinpoint who controls companies involved in illegal fishing activities.</p>
<p>While this plot provides a static snapshot, in the following we shall create similar plots for different time periods can reveal changes in ownership and influence over time.</p>
</section>
<section id="part-2-temporal-analysis" class="level3">
<h3 class="anchored" data-anchor-id="part-2-temporal-analysis">Part 2: Temporal Analysis</h3>
<p>Aggregate Ownership Changes by Year</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>change_over_time1 <span class="ot">&lt;-</span> links_owns <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(start_date) <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>links_owns<span class="ot">&lt;-</span> links_owns <span class="sc">%&gt;%</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_year =</span> <span class="fu">format</span>(start_date, <span class="st">"%Y"</span>))</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate ownership changes by year</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>change_over_time <span class="ot">&lt;-</span> links_owns <span class="sc">%&gt;%</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(start_year) <span class="sc">%&gt;%</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Create plots to visualize the changes in ownership over time.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot changes over time</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(change_over_time, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(start_year), <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Changes in Ownership Over Time"</span>,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Ownership Changes"</span>) <span class="sc">+</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="takehome3new_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="part-2-network-graph-by-year" class="level3">
<h3 class="anchored" data-anchor-id="part-2-network-graph-by-year">Part 2: Network Graph by Year</h3>
<p>Given the significant increase in data from 2004 onwards, focusing on every 10 years from 2005 to 2035 would provide a more detailed analysis of changes in ownership and influence.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the year </span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>filter_year <span class="ot">&lt;-</span> <span class="dv">2005</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter vip_connections by start_year</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>vip_connections_filtered <span class="ot">&lt;-</span> vip_connections <span class="sc">%&gt;%</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">format</span>(start_date, <span class="st">"%Y"</span>) <span class="sc">==</span> filter_year)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the graph object from the filtered vip_connections</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>g_vip_filtered <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> vip_connections_filtered, <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify VIPs (nodes_people) and Companies</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g_vip_filtered)<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g_vip_filtered)<span class="sc">$</span>name <span class="sc">%in%</span> nodes_people<span class="sc">$</span>id, <span class="st">"VIP"</span>, <span class="st">"Company"</span>)</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Define colors and sizes</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g_vip_filtered)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g_vip_filtered)<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"VIP"</span>, <span class="st">"blue"</span>, <span class="st">"orange"</span>)</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g_vip_filtered)<span class="sc">$</span>size <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g_vip_filtered)<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"VIP"</span>, <span class="dv">8</span>, <span class="dv">5</span>)</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the network</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>p2005<span class="ot">&lt;-</span><span class="fu">plot</span>(g_vip_filtered, <span class="at">vertex.label =</span> <span class="cn">NA</span>, <span class="at">vertex.size =</span> <span class="fu">V</span>(g_vip_filtered)<span class="sc">$</span>size, <span class="at">edge.arrow.size =</span> <span class="fl">0.5</span>, </span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.color =</span> <span class="fu">V</span>(g_vip_filtered)<span class="sc">$</span>color, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"VIP Connections Network for"</span>, filter_year))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="takehome3new_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In 2005, the network shows a relatively sparse structure with a moderate number of connections. VIPs (blue nodes) are moderately interconnected, indicating a balanced distribution of influence among several key players.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the year</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>filter_year <span class="ot">&lt;-</span> <span class="dv">2015</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter vip_connections by start_year</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>vip_connections_filtered_2015 <span class="ot">&lt;-</span> vip_connections <span class="sc">%&gt;%</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">format</span>(start_date, <span class="st">"%Y"</span>) <span class="sc">==</span> filter_year)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the graph object from the filtered vip_connections</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>g_vip_filtered_2015 <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> vip_connections_filtered_2015, <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify VIPs (nodes_people) and Companies</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g_vip_filtered_2015)<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g_vip_filtered_2015)<span class="sc">$</span>name <span class="sc">%in%</span> nodes_people<span class="sc">$</span>id, <span class="st">"VIP"</span>, <span class="st">"Company"</span>)</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Define colors and sizes</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g_vip_filtered_2015)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g_vip_filtered_2015)<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"VIP"</span>, <span class="st">"blue"</span>, <span class="st">"orange"</span>)</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g_vip_filtered_2015)<span class="sc">$</span>size <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g_vip_filtered_2015)<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"VIP"</span>, <span class="dv">8</span>, <span class="dv">5</span>)</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the network</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>p2015 <span class="ot">&lt;-</span> <span class="fu">plot</span>(g_vip_filtered_2015, <span class="at">vertex.label =</span> <span class="cn">NA</span>, <span class="at">vertex.size =</span> <span class="fu">V</span>(g_vip_filtered_2015)<span class="sc">$</span>size, <span class="at">edge.arrow.size =</span> <span class="fl">0.5</span>, </span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.color =</span> <span class="fu">V</span>(g_vip_filtered_2015)<span class="sc">$</span>color, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"VIP Connections Network for"</span>, filter_year))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="takehome3new_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>By 2015, the network has grown denser, suggesting increased interconnectedness and influence consolidation. More VIPs are connected to multiple companies (orange nodes), indicating a significant rise in their influence and control over the network.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the year</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>filter_year <span class="ot">&lt;-</span> <span class="dv">2025</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter vip_connections by start_year</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>vip_connections_filtered_2025 <span class="ot">&lt;-</span> vip_connections <span class="sc">%&gt;%</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">format</span>(start_date, <span class="st">"%Y"</span>) <span class="sc">==</span> filter_year)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the graph object from the filtered vip_connections</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>g_vip_filtered_2025 <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> vip_connections_filtered_2025, <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify VIPs (nodes_people) and Companies</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g_vip_filtered_2025)<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g_vip_filtered_2025)<span class="sc">$</span>name <span class="sc">%in%</span> nodes_people<span class="sc">$</span>id, <span class="st">"VIP"</span>, <span class="st">"Company"</span>)</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Define colors and sizes</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g_vip_filtered_2025)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g_vip_filtered_2025)<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"VIP"</span>, <span class="st">"blue"</span>, <span class="st">"orange"</span>)</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g_vip_filtered_2025)<span class="sc">$</span>size <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g_vip_filtered_2025)<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"VIP"</span>, <span class="dv">8</span>, <span class="dv">5</span>)</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the network</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>p2025 <span class="ot">&lt;-</span> <span class="fu">plot</span>(g_vip_filtered_2025, <span class="at">vertex.label =</span> <span class="cn">NA</span>, <span class="at">vertex.size =</span> <span class="fu">V</span>(g_vip_filtered_2025)<span class="sc">$</span>size, <span class="at">edge.arrow.size =</span> <span class="fl">0.5</span>, </span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.color =</span> <span class="fu">V</span>(g_vip_filtered_2025)<span class="sc">$</span>color, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"VIP Connections Network for"</span>, filter_year))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="takehome3new_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The network continues to expand in 2025, displaying even more complexity and interconnections. This period likely represents a peak in influence for several VIPs, with many of them owning shares in numerous companies, suggesting increased market control.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the year</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>filter_year <span class="ot">&lt;-</span> <span class="dv">2035</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter vip_connections by start_year</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>vip_connections_filtered_2035 <span class="ot">&lt;-</span> vip_connections <span class="sc">%&gt;%</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">format</span>(start_date, <span class="st">"%Y"</span>) <span class="sc">==</span> filter_year)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the graph object from the filtered vip_connections</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>g_vip_filtered_2035 <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> vip_connections_filtered_2035, <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify VIPs (nodes_people) and Companies</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g_vip_filtered_2035)<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g_vip_filtered_2035)<span class="sc">$</span>name <span class="sc">%in%</span> nodes_people<span class="sc">$</span>id, <span class="st">"VIP"</span>, <span class="st">"Company"</span>)</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Define colors and sizes</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g_vip_filtered_2035)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g_vip_filtered_2035)<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"VIP"</span>, <span class="st">"blue"</span>, <span class="st">"orange"</span>)</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g_vip_filtered_2035)<span class="sc">$</span>size <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g_vip_filtered_2035)<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"VIP"</span>, <span class="dv">8</span>, <span class="dv">5</span>)</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the network</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>p2035 <span class="ot">&lt;-</span> <span class="fu">plot</span>(g_vip_filtered_2035, <span class="at">vertex.label =</span> <span class="cn">NA</span>, <span class="at">vertex.size =</span> <span class="fu">V</span>(g_vip_filtered_2035)<span class="sc">$</span>size, <span class="at">edge.arrow.size =</span> <span class="fl">0.5</span>, </span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.color =</span> <span class="fu">V</span>(g_vip_filtered_2035)<span class="sc">$</span>color, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"VIP Connections Network for"</span>, filter_year))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="takehome3new_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In 2035, the network structure shifts to a star-like formation, where a central VIP appears to have gained substantial influence, with direct connections to numerous companies. This indicates a significant consolidation of power and influence, where a few key players dominate the network.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>Initially, influence is distributed among several key players, but over the years, it becomes concentrated among fewer individuals, leading to a highly centralized network by 2035. This centralization of power can be both an opportunity for streamlined decision-making and a risk for monopolistic control. Monitoring these changes is crucial for regulatory bodies like FishEye to ensure fair practices and prevent illegal activities within the network.</p>
</div>
</div>
</section>
</section>
<section id="question-4" class="level2">
<h2 class="anchored" data-anchor-id="question-4">Question 4</h2>
<p>For part 1, the focus was on identifying the network associated with SouthSeafood Express Corp and visualizing how this network and competing businesses changed as a result of their illegal fishing behavior.</p>
<section id="part-1-identify-southseafood-express-corp-node" class="level4">
<h4 class="anchored" data-anchor-id="part-1-identify-southseafood-express-corp-node">Part 1: Identify SouthSeafood Express Corp Node</h4>
<ul>
<li><p>Locate the node representing SouthSeafood Express Corp in the network.</p></li>
<li><p>Create a visualization of the network associated with SouthSeafood Express Corp before any changes.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract edges connected to SouthSeafood Express Corp</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>southseafood_edges <span class="ot">&lt;-</span> cleaned_links <span class="sc">%&gt;%</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source <span class="sc">==</span> <span class="st">"SouthSeafood Express Corp"</span> <span class="sc">|</span> target <span class="sc">==</span> <span class="st">"SouthSeafood Express Corp"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source,target,start_date,end_date,event2)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure all nodes in the edge list are present in the vertex data frame</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>southseafood_nodes <span class="ot">&lt;-</span> cleaned_nodes <span class="sc">%&gt;%</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">%in%</span> (<span class="fu">c</span>(southseafood_edges<span class="sc">$</span>source, southseafood_edges<span class="sc">$</span>target)))</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Join edges with nodes to ensure all nodes are present</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>southseafood_edges <span class="ot">&lt;-</span> southseafood_edges <span class="sc">%&gt;%</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source <span class="sc">%in%</span> southseafood_nodes<span class="sc">$</span>id <span class="sc">&amp;</span> target <span class="sc">%in%</span> southseafood_nodes<span class="sc">$</span>id)</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create graph object for the sub-network</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>g_southseafood <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> southseafood_edges, <span class="at">vertices =</span> southseafood_nodes, <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the initial network</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g_southseafood, <span class="at">vertex.label =</span> <span class="cn">NA</span>, <span class="at">vertex.size =</span> <span class="dv">5</span>, <span class="at">edge.arrow.size =</span> <span class="fl">0.5</span>, </span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.color =</span> <span class="st">"orange"</span>, <span class="at">main =</span> <span class="st">"Network Associated with SouthSeafood Express Corp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="takehome3new_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="part-1-identify-competing-businesses" class="level4">
<h4 class="anchored" data-anchor-id="part-1-identify-competing-businesses">Part 1: Identify Competing Businesses</h4>
<p>Identify and highlight competing businesses within the extracted sub-network.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>competing_businesses <span class="ot">&lt;-</span> cleaned_nodes <span class="sc">%&gt;%</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(entity3 <span class="sc">==</span> <span class="st">"FishingCompany"</span> <span class="sc">&amp;</span> id <span class="sc">!=</span> <span class="st">"SouthSeafood Express Corp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>competing_edges <span class="ot">&lt;-</span> cleaned_links <span class="sc">%&gt;%</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source <span class="sc">%in%</span> competing_businesses<span class="sc">$</span>id <span class="sc">|</span> target <span class="sc">%in%</span> competing_businesses<span class="sc">$</span>id) <span class="sc">%&gt;%</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source, target, start_date, end_date, event2)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine SouthSeafood Express Corp edges with competing businesses edges</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>combined_edges <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(southseafood_edges, competing_edges)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the combined set of nodes</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>combined_nodes <span class="ot">&lt;-</span> cleaned_nodes <span class="sc">%&gt;%</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">%in%</span> <span class="fu">c</span>(combined_edges<span class="sc">$</span>source, combined_edges<span class="sc">$</span>target))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create graph object for the combined network</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>g_combined <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> combined_edges, <span class="at">vertices =</span> combined_nodes, <span class="at">directed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-1-analyze-temporal-changes-based-on-start_year" class="level4">
<h4 class="anchored" data-anchor-id="part-1-analyze-temporal-changes-based-on-start_year">Part 1: Analyze Temporal Changes based on <em>start_year</em></h4>
<ul>
<li><p>Filter the data to show the network before and after the illegal fishing incident(assume the incident happened in 2023)</p></li>
<li><p>Create visualizations to compare the network structure and connections before and after the incident.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assume the accident happened in 2023</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>incident_year <span class="ot">&lt;-</span> <span class="dv">2023</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter edges before the incident</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>edges_before <span class="ot">&lt;-</span> combined_edges <span class="sc">%&gt;%</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">format</span>(start_date, <span class="st">"%Y"</span>) <span class="sc">&lt;</span> incident_year)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter edges after the incident</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>edges_after <span class="ot">&lt;-</span> combined_edges <span class="sc">%&gt;%</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">format</span>(start_date, <span class="st">"%Y"</span>) <span class="sc">&gt;=</span> incident_year)</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create graph objects for before and after the incident</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>g_before <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> edges_before, <span class="at">vertices =</span> combined_nodes, <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>g_after <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> edges_after, <span class="at">vertices =</span> combined_nodes, <span class="at">directed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-1-visualize-the-temporal-changes" class="level4">
<h4 class="anchored" data-anchor-id="part-1-visualize-the-temporal-changes">Part 1: Visualize the Temporal Changes</h4>
<p>Identify and highlight significant changes in connections and structure due to the illegal fishing behavior and subsequent closure.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>plot_before <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(g_before, <span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">edge_alpha =</span> <span class="fl">0.8</span>), <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">ifelse</span>(name <span class="sc">==</span> <span class="st">"SouthSeafood Express Corp"</span>, <span class="st">"SouthSeafood"</span>, </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">ifelse</span>(type <span class="sc">==</span> <span class="st">"Entity.Organization.FishingCompany"</span>, <span class="st">"FishingCompany"</span>, <span class="st">"Other"</span>))), </span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="co"># Adjusted alpha for transparency</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"SouthSeafood"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"FishingCompany"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Other"</span> <span class="ot">=</span> <span class="st">"orange"</span>),</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="st">"Type"</span>) <span class="sc">+</span> <span class="co"># Shortened legend title</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Network Before Incident"</span>)</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot for the network before the incident</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>plot_before</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="takehome3new_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>plot_after <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(g_after, <span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">edge_alpha =</span> <span class="fl">0.8</span>), <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">ifelse</span>(name <span class="sc">==</span> <span class="st">"SouthSeafood Express Corp"</span>, <span class="st">"SouthSeafood"</span>, </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">ifelse</span>(type <span class="sc">==</span> <span class="st">"Entity.Organization.FishingCompany"</span>, <span class="st">"FishingCompany"</span>, <span class="st">"Other"</span>))), </span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="co"># Adjusted alpha for transparency</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"SouthSeafood"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"FishingCompany"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Other"</span> <span class="ot">=</span> <span class="st">"orange"</span>),</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="st">"Type"</span>) <span class="sc">+</span> <span class="co"># Shortened legend title</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Network After Incident"</span>)</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot for the network after the incident</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>plot_after</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="takehome3new_files/figure-html/unnamed-chunk-35-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Observations</strong>:</p>
<ul>
<li><p>The number of blue nodes (fishing companies) appears to have decreased.</p></li>
<li><p>SouthSeafood Express Corp (red node) remains central but its connections might have changed, indicating possible impact from the incident.</p></li>
</ul>
</div>
</div>
<p>For part 2, since we cannot use revenue data over time, we will focus on identifying which companies potentially benefited from SouthSeafood Express Corp’s legal troubles by analyzing changes in network centrality measures.</p>
</section>
<section id="part-2-calculate-centrality-measures-before-and-after-the-incident" class="level4">
<h4 class="anchored" data-anchor-id="part-2-calculate-centrality-measures-before-and-after-the-incident">Part 2: Calculate Centrality Measures Before and After the Incident</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate degree centrality before the incident</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>degree_before <span class="ot">&lt;-</span> <span class="fu">degree</span>(g_before, <span class="at">mode =</span> <span class="st">"all"</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate degree centrality after the incident</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>degree_after <span class="ot">&lt;-</span> <span class="fu">degree</span>(g_after, <span class="at">mode =</span> <span class="st">"all"</span>)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine degree centrality measures into a data frame</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>centrality_change <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="fu">names</span>(degree_before),</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">degree_before =</span> degree_before,</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">degree_after =</span> degree_after</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the change in degree centrality</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>centrality_change <span class="ot">&lt;-</span> centrality_change <span class="sc">%&gt;%</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">change =</span> degree_after <span class="sc">-</span> degree_before)</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Display companies with the most positive change in degree centrality</span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>top_beneficiaries <span class="ot">&lt;-</span> centrality_change <span class="sc">%&gt;%</span></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(change)) <span class="sc">%&gt;%</span></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(top_beneficiaries)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                           id degree_before degree_after change
Anderson-Roberts             Anderson-Roberts             0           36     36
Hall, Hartman and Hall Hall, Hartman and Hall             0           30     30
Kirk Inc                             Kirk Inc             0           18     18
Watson-Gray                       Watson-Gray             0           18     18
Parker Inc                         Parker Inc             0           17     17
Mullins-Carrillo             Mullins-Carrillo             0           15     15
Torres, Ross and Brown Torres, Ross and Brown             0           14     14
Byrd and Sons                   Byrd and Sons             0           13     13
Haynes-Lucero                   Haynes-Lucero             0           13     13
Lutz-Fleming                     Lutz-Fleming             0           13     13</code></pre>
</div>
</div>
</section>
<section id="part-2-determine-entity-type" class="level4">
<h4 class="anchored" data-anchor-id="part-2-determine-entity-type">Part 2: Determine Entity Type</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge with cleaned_nodes to get the entity type</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>top_beneficiaries_info <span class="ot">&lt;-</span> top_beneficiaries <span class="sc">%&gt;%</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(cleaned_nodes, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, change,entity3)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the entity type of top beneficiaries</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(top_beneficiaries_info)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                       id change        entity3
1        Anderson-Roberts     36 FishingCompany
2  Hall, Hartman and Hall     30 FishingCompany
3                Kirk Inc     18 FishingCompany
4             Watson-Gray     18 FishingCompany
5              Parker Inc     17 FishingCompany
6        Mullins-Carrillo     15 FishingCompany
7  Torres, Ross and Brown     14 FishingCompany
8           Byrd and Sons     13 FishingCompany
9           Haynes-Lucero     13 FishingCompany
10           Lutz-Fleming     13 FishingCompany</code></pre>
</div>
</div>
</section>
<section id="part-2-visualize-the-changes" class="level4">
<h4 class="anchored" data-anchor-id="part-2-visualize-the-changes">Part 2: Visualize the Changes</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot of top beneficiaries</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top_beneficiaries_info, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(id, change), <span class="at">y =</span> change)) <span class="sc">+</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top Beneficiaries by Change in Degree Centrality"</span>,</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Company"</span>,</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Change in Degree Centrality"</span>,</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Entity Type"</span>) <span class="sc">+</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="takehome3new_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The results show that the top beneficiaries, all classified as fishing companies, significantly increased their network centrality following SouthSeafood Express Corp’s legal troubles. Anderson-Roberts, Hall, Hartman and Hall, and Kirk Inc., among others, saw the largest gains, suggesting they capitalized on the shift in the network’s structure.</p>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb61" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "takehome3"</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Ke Ke"</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "18 May 2024"</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="an">date-modified:</span><span class="co"> "last-modified"</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a><span class="co">  freeze: true</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>In this VAST Challenge project, we analyze the impact of SouthSeafood Express Corp's illegal fishing on the business network. The first question explores how the network and competing businesses change due to the incident. The second question identifies which companies benefited from SouthSeafood Express Corp's legal troubles.</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a><span class="fu">## Getting Started</span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidytext, readtext, quanteda, tidyverse, jsonlite, igraph, tidygraph, ggraph, visNetwork, clock, graphlayouts,ggplot2)</span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a><span class="fu">## **Importing JSON File**</span></span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>Direct import of the mc3.json file shows an error message indicating that there's an invalid character in the JSON text, specifically "NaN". As "NaN" is not recognised as a valid value, preprocessing of the JSON file to replace "NaN" is required.</span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the JSON file as text</span></span>
<span id="cb61-33"><a href="#cb61-33" aria-hidden="true" tabindex="-1"></a>json_text <span class="ot">&lt;-</span> <span class="fu">readLines</span>(<span class="st">"data/mc3.json"</span> ,<span class="at">warn =</span> <span class="cn">FALSE</span>)</span>
<span id="cb61-34"><a href="#cb61-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-35"><a href="#cb61-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace "NaN" with "null"</span></span>
<span id="cb61-36"><a href="#cb61-36" aria-hidden="true" tabindex="-1"></a>json_text_fixed <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"NaN"</span>, <span class="st">"null"</span>, json_text)</span>
<span id="cb61-37"><a href="#cb61-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-38"><a href="#cb61-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Write the fixed JSON text back to a file</span></span>
<span id="cb61-39"><a href="#cb61-39" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(json_text_fixed, <span class="st">"data/mc3_fixed.json"</span>)</span>
<span id="cb61-40"><a href="#cb61-40" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-41"><a href="#cb61-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-42"><a href="#cb61-42" aria-hidden="true" tabindex="-1"></a>Importing preprocessed mc3_fixed.json file</span>
<span id="cb61-43"><a href="#cb61-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-46"><a href="#cb61-46" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-47"><a href="#cb61-47" aria-hidden="true" tabindex="-1"></a>mc3_data <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/mc3_fixed.json"</span>)</span>
<span id="cb61-48"><a href="#cb61-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-49"><a href="#cb61-49" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-50"><a href="#cb61-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-51"><a href="#cb61-51" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Cleaning</span></span>
<span id="cb61-52"><a href="#cb61-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-53"><a href="#cb61-53" aria-hidden="true" tabindex="-1"></a><span class="fu">### Missing Values</span></span>
<span id="cb61-54"><a href="#cb61-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-55"><a href="#cb61-55" aria-hidden="true" tabindex="-1"></a>Identify the percentage of missing values within the dataset</span>
<span id="cb61-56"><a href="#cb61-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-59"><a href="#cb61-59" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-60"><a href="#cb61-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate missing value percentages</span></span>
<span id="cb61-61"><a href="#cb61-61" aria-hidden="true" tabindex="-1"></a>calculate_missing_percentage <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb61-62"><a href="#cb61-62" aria-hidden="true" tabindex="-1"></a>  total_values <span class="ot">&lt;-</span> <span class="fu">nrow</span>(df) <span class="sc">*</span> <span class="fu">ncol</span>(df)</span>
<span id="cb61-63"><a href="#cb61-63" aria-hidden="true" tabindex="-1"></a>  missing_values <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(df))</span>
<span id="cb61-64"><a href="#cb61-64" aria-hidden="true" tabindex="-1"></a>  missing_percentage <span class="ot">&lt;-</span> (missing_values <span class="sc">/</span> total_values) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb61-65"><a href="#cb61-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(missing_percentage)</span>
<span id="cb61-66"><a href="#cb61-66" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-67"><a href="#cb61-67" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-68"><a href="#cb61-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-69"><a href="#cb61-69" aria-hidden="true" tabindex="-1"></a>Missing percentage of nodes</span>
<span id="cb61-70"><a href="#cb61-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-73"><a href="#cb61-73" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-74"><a href="#cb61-74" aria-hidden="true" tabindex="-1"></a>nodes_missing_percentage <span class="ot">&lt;-</span> <span class="fu">calculate_missing_percentage</span>(mc3_data[[<span class="st">"nodes"</span>]])</span>
<span id="cb61-75"><a href="#cb61-75" aria-hidden="true" tabindex="-1"></a>nodes_missing_percentage</span>
<span id="cb61-76"><a href="#cb61-76" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-77"><a href="#cb61-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-80"><a href="#cb61-80" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-81"><a href="#cb61-81" aria-hidden="true" tabindex="-1"></a>nodes_missing_by_column <span class="ot">&lt;-</span> <span class="fu">sapply</span>(mc3_data[[<span class="st">"nodes"</span>]], <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x)) <span class="sc">/</span> <span class="fu">length</span>(x) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb61-82"><a href="#cb61-82" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-83"><a href="#cb61-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-84"><a href="#cb61-84" aria-hidden="true" tabindex="-1"></a>Missing percentage of edges</span>
<span id="cb61-85"><a href="#cb61-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-88"><a href="#cb61-88" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-89"><a href="#cb61-89" aria-hidden="true" tabindex="-1"></a>links_missing_percentage <span class="ot">&lt;-</span> <span class="fu">calculate_missing_percentage</span>(mc3_data[[<span class="st">"links"</span>]])</span>
<span id="cb61-90"><a href="#cb61-90" aria-hidden="true" tabindex="-1"></a>links_missing_percentage</span>
<span id="cb61-91"><a href="#cb61-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-92"><a href="#cb61-92" aria-hidden="true" tabindex="-1"></a>links_missing_by_column <span class="ot">&lt;-</span> <span class="fu">sapply</span>(mc3_data[[<span class="st">"links"</span>]], <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x)) <span class="sc">/</span> <span class="fu">length</span>(x) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb61-93"><a href="#cb61-93" aria-hidden="true" tabindex="-1"></a>links_missing_by_column</span>
<span id="cb61-94"><a href="#cb61-94" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-95"><a href="#cb61-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-96"><a href="#cb61-96" aria-hidden="true" tabindex="-1"></a>Print missing percentages</span>
<span id="cb61-97"><a href="#cb61-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-100"><a href="#cb61-100" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-101"><a href="#cb61-101" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb61-102"><a href="#cb61-102" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(nodes_missing_percentage)</span>
<span id="cb61-103"><a href="#cb61-103" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(nodes_missing_by_column)</span>
<span id="cb61-104"><a href="#cb61-104" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(links_missing_percentage)</span>
<span id="cb61-105"><a href="#cb61-105" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(links_missing_by_column)</span>
<span id="cb61-106"><a href="#cb61-106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-107"><a href="#cb61-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-108"><a href="#cb61-108" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb61-109"><a href="#cb61-109" aria-hidden="true" tabindex="-1"></a><span class="fu">## Observations:</span></span>
<span id="cb61-110"><a href="#cb61-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-111"><a href="#cb61-111" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Nodes Data:**</span>
<span id="cb61-112"><a href="#cb61-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-113"><a href="#cb61-113" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`ProductServices`</span>, <span class="in">`PointOfContact`</span>, <span class="in">`HeadOfOrg`</span>, <span class="in">`founding_date`</span>, <span class="in">`revenue`</span>, and <span class="in">`TradeDescription`</span> columns have a high percentage of missing values (around 85%).</span>
<span id="cb61-114"><a href="#cb61-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-115"><a href="#cb61-115" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>The <span class="in">`dob`</span> column has about 14.7% missing values.</span>
<span id="cb61-116"><a href="#cb61-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-117"><a href="#cb61-117" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Other columns (<span class="in">`type`</span>, <span class="in">`country`</span>, <span class="in">`_last_edited_by`</span>, <span class="in">`_last_edited_date`</span>, <span class="in">`_date_added`</span>, <span class="in">`_raw_source`</span>, <span class="in">`_algorithm`</span>, and <span class="in">`id`</span>) have no missing values.</span>
<span id="cb61-118"><a href="#cb61-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-119"><a href="#cb61-119" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Links Data:**</span>
<span id="cb61-120"><a href="#cb61-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-121"><a href="#cb61-121" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`end_date`</span> has a very high percentage of missing values (around 99.5%).</span>
<span id="cb61-122"><a href="#cb61-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-123"><a href="#cb61-123" aria-hidden="true" tabindex="-1"></a><span class="fu">## Actions:</span></span>
<span id="cb61-124"><a href="#cb61-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-125"><a href="#cb61-125" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Filled missing values in <span class="in">`HeadOfOrg`</span> with "Unknown".</span>
<span id="cb61-126"><a href="#cb61-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-127"><a href="#cb61-127" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Filled missing values in <span class="in">`revenue`</span> with 0.</span>
<span id="cb61-128"><a href="#cb61-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-129"><a href="#cb61-129" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Filled missing values in <span class="in">`start_date`</span> and <span class="in">`end_date`</span> with "Unknown".</span>
<span id="cb61-130"><a href="#cb61-130" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb61-131"><a href="#cb61-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-132"><a href="#cb61-132" aria-hidden="true" tabindex="-1"></a>Handle missing values</span>
<span id="cb61-133"><a href="#cb61-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-136"><a href="#cb61-136" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-137"><a href="#cb61-137" aria-hidden="true" tabindex="-1"></a><span class="co"># Select crucial columns and fill missing values where appropriate</span></span>
<span id="cb61-138"><a href="#cb61-138" aria-hidden="true" tabindex="-1"></a>cleaned_nodes <span class="ot">&lt;-</span> mc3_data[[<span class="st">"nodes"</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb61-139"><a href="#cb61-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, type, country, HeadOfOrg, revenue,ProductServices,PointOfContact,founding_date,TradeDescription,dob,</span>
<span id="cb61-140"><a href="#cb61-140" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">_last_edited_by</span><span class="st">`</span>, <span class="st">`</span><span class="at">_last_edited_date</span><span class="st">`</span>, <span class="st">`</span><span class="at">_date_added</span><span class="st">`</span>, <span class="st">`</span><span class="at">_raw_source</span><span class="st">`</span>, <span class="st">`</span><span class="at">_algorithm</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-141"><a href="#cb61-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">HeadOfOrg =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(HeadOfOrg), <span class="st">"Unknown"</span>, HeadOfOrg),</span>
<span id="cb61-142"><a href="#cb61-142" aria-hidden="true" tabindex="-1"></a>         <span class="at">revenue =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(revenue), <span class="dv">0</span>, revenue))</span>
<span id="cb61-143"><a href="#cb61-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-144"><a href="#cb61-144" aria-hidden="true" tabindex="-1"></a><span class="co"># Handle missing values in links</span></span>
<span id="cb61-145"><a href="#cb61-145" aria-hidden="true" tabindex="-1"></a><span class="co"># Select crucial columns and fill missing values where appropriate</span></span>
<span id="cb61-146"><a href="#cb61-146" aria-hidden="true" tabindex="-1"></a>cleaned_links <span class="ot">&lt;-</span> mc3_data[[<span class="st">"links"</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb61-147"><a href="#cb61-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(key,source, target, type, start_date, end_date, <span class="st">`</span><span class="at">_last_edited_by</span><span class="st">`</span>, <span class="st">`</span><span class="at">_last_edited_date</span><span class="st">`</span>, <span class="st">`</span><span class="at">_date_added</span><span class="st">`</span>, <span class="st">`</span><span class="at">_raw_source</span><span class="st">`</span>, <span class="st">`</span><span class="at">_algorithm</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-148"><a href="#cb61-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_date =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(start_date), <span class="st">"Unknown"</span>, start_date),</span>
<span id="cb61-149"><a href="#cb61-149" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_date =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(end_date), <span class="st">"Unknown"</span>, end_date))</span>
<span id="cb61-150"><a href="#cb61-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-151"><a href="#cb61-151" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure proper data types</span></span>
<span id="cb61-152"><a href="#cb61-152" aria-hidden="true" tabindex="-1"></a>cleaned_nodes <span class="ot">&lt;-</span> cleaned_nodes <span class="sc">%&gt;%</span></span>
<span id="cb61-153"><a href="#cb61-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb61-154"><a href="#cb61-154" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> <span class="fu">as.character</span>(id),</span>
<span id="cb61-155"><a href="#cb61-155" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="fu">as.character</span>(type),</span>
<span id="cb61-156"><a href="#cb61-156" aria-hidden="true" tabindex="-1"></a>    <span class="at">country =</span> <span class="fu">as.character</span>(country),</span>
<span id="cb61-157"><a href="#cb61-157" aria-hidden="true" tabindex="-1"></a>    <span class="at">HeadOfOrg =</span> <span class="fu">as.character</span>(HeadOfOrg),</span>
<span id="cb61-158"><a href="#cb61-158" aria-hidden="true" tabindex="-1"></a>    <span class="at">revenue =</span> <span class="fu">as.numeric</span>(revenue),</span>
<span id="cb61-159"><a href="#cb61-159" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_last_edited_by</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">_last_edited_by</span><span class="st">`</span>),</span>
<span id="cb61-160"><a href="#cb61-160" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_last_edited_date</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">_last_edited_date</span><span class="st">`</span>),</span>
<span id="cb61-161"><a href="#cb61-161" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_date_added</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">_date_added</span><span class="st">`</span>),</span>
<span id="cb61-162"><a href="#cb61-162" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_raw_source</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">_raw_source</span><span class="st">`</span>),</span>
<span id="cb61-163"><a href="#cb61-163" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_algorithm</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">_algorithm</span><span class="st">`</span>)</span>
<span id="cb61-164"><a href="#cb61-164" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb61-165"><a href="#cb61-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-166"><a href="#cb61-166" aria-hidden="true" tabindex="-1"></a>cleaned_links <span class="ot">&lt;-</span> cleaned_links <span class="sc">%&gt;%</span></span>
<span id="cb61-167"><a href="#cb61-167" aria-hidden="true" tabindex="-1"></a> <span class="fu">mutate</span>(</span>
<span id="cb61-168"><a href="#cb61-168" aria-hidden="true" tabindex="-1"></a>    <span class="at">source =</span> <span class="fu">as.character</span>(source),</span>
<span id="cb61-169"><a href="#cb61-169" aria-hidden="true" tabindex="-1"></a>    <span class="at">target =</span> <span class="fu">as.character</span>(target),</span>
<span id="cb61-170"><a href="#cb61-170" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="fu">as.character</span>(type),</span>
<span id="cb61-171"><a href="#cb61-171" aria-hidden="true" tabindex="-1"></a>    <span class="at">start_date =</span> <span class="fu">as.character</span>(start_date),</span>
<span id="cb61-172"><a href="#cb61-172" aria-hidden="true" tabindex="-1"></a>    <span class="at">end_date =</span> <span class="fu">as.character</span>(end_date),</span>
<span id="cb61-173"><a href="#cb61-173" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_last_edited_by</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">_last_edited_by</span><span class="st">`</span>),</span>
<span id="cb61-174"><a href="#cb61-174" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_last_edited_date</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">_last_edited_date</span><span class="st">`</span>),</span>
<span id="cb61-175"><a href="#cb61-175" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_date_added</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">_date_added</span><span class="st">`</span>),</span>
<span id="cb61-176"><a href="#cb61-176" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_raw_source</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">_raw_source</span><span class="st">`</span>),</span>
<span id="cb61-177"><a href="#cb61-177" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_algorithm</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">_algorithm</span><span class="st">`</span>)</span>
<span id="cb61-178"><a href="#cb61-178" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb61-179"><a href="#cb61-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-180"><a href="#cb61-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-181"><a href="#cb61-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-182"><a href="#cb61-182" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-183"><a href="#cb61-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-184"><a href="#cb61-184" aria-hidden="true" tabindex="-1"></a><span class="fu">### Check for data types</span></span>
<span id="cb61-185"><a href="#cb61-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-188"><a href="#cb61-188" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-189"><a href="#cb61-189" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure correct data types for nodes</span></span>
<span id="cb61-190"><a href="#cb61-190" aria-hidden="true" tabindex="-1"></a>cleaned_nodes <span class="ot">&lt;-</span> cleaned_nodes <span class="sc">%&gt;%</span></span>
<span id="cb61-191"><a href="#cb61-191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb61-192"><a href="#cb61-192" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> <span class="fu">as.character</span>(id),</span>
<span id="cb61-193"><a href="#cb61-193" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="fu">as.character</span>(type),</span>
<span id="cb61-194"><a href="#cb61-194" aria-hidden="true" tabindex="-1"></a>    <span class="at">country =</span> <span class="fu">as.character</span>(country),</span>
<span id="cb61-195"><a href="#cb61-195" aria-hidden="true" tabindex="-1"></a>    <span class="at">HeadOfOrg =</span> <span class="fu">as.character</span>(HeadOfOrg),</span>
<span id="cb61-196"><a href="#cb61-196" aria-hidden="true" tabindex="-1"></a>    <span class="at">revenue =</span> <span class="fu">as.numeric</span>(revenue),</span>
<span id="cb61-197"><a href="#cb61-197" aria-hidden="true" tabindex="-1"></a>      <span class="at">dob =</span> <span class="fu">as.POSIXct</span>(dob, <span class="at">format=</span><span class="st">"%Y-%m-%dT%H:%M:%S"</span>),</span>
<span id="cb61-198"><a href="#cb61-198" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_last_edited_by</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">_last_edited_by</span><span class="st">`</span>),</span>
<span id="cb61-199"><a href="#cb61-199" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_last_edited_date</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.POSIXct</span>(<span class="st">`</span><span class="at">_last_edited_date</span><span class="st">`</span>, <span class="at">format=</span><span class="st">"%Y-%m-%dT%H:%M:%S"</span>),</span>
<span id="cb61-200"><a href="#cb61-200" aria-hidden="true" tabindex="-1"></a>    <span class="at">founding_date=</span><span class="fu">as.POSIXct</span>(founding_date, <span class="at">format=</span><span class="st">"%Y-%m-%dT%H:%M:%S"</span>),</span>
<span id="cb61-201"><a href="#cb61-201" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_date_added</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.POSIXct</span>(<span class="st">`</span><span class="at">_date_added</span><span class="st">`</span>, <span class="at">format=</span><span class="st">"%Y-%m-%dT%H:%M:%S"</span>),</span>
<span id="cb61-202"><a href="#cb61-202" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_raw_source</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">_raw_source</span><span class="st">`</span>),</span>
<span id="cb61-203"><a href="#cb61-203" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_algorithm</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">_algorithm</span><span class="st">`</span>)</span>
<span id="cb61-204"><a href="#cb61-204" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb61-205"><a href="#cb61-205" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb61-206"><a href="#cb61-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-207"><a href="#cb61-207" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure correct data types for links</span></span>
<span id="cb61-208"><a href="#cb61-208" aria-hidden="true" tabindex="-1"></a>cleaned_links <span class="ot">&lt;-</span> cleaned_links <span class="sc">%&gt;%</span></span>
<span id="cb61-209"><a href="#cb61-209" aria-hidden="true" tabindex="-1"></a> <span class="fu">mutate</span>(</span>
<span id="cb61-210"><a href="#cb61-210" aria-hidden="true" tabindex="-1"></a>    <span class="at">source =</span> <span class="fu">as.character</span>(source),</span>
<span id="cb61-211"><a href="#cb61-211" aria-hidden="true" tabindex="-1"></a>    <span class="at">target =</span> <span class="fu">as.character</span>(target),</span>
<span id="cb61-212"><a href="#cb61-212" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="fu">as.character</span>(type),</span>
<span id="cb61-213"><a href="#cb61-213" aria-hidden="true" tabindex="-1"></a>    <span class="at">start_date =</span> <span class="fu">as.POSIXct</span>(start_date, <span class="at">format=</span><span class="st">"%Y-%m-%dT%H:%M:%S"</span>),</span>
<span id="cb61-214"><a href="#cb61-214" aria-hidden="true" tabindex="-1"></a>    <span class="at">end_date =</span> <span class="fu">as.POSIXct</span>(end_date, <span class="at">format=</span><span class="st">"%Y-%m-%dT%H:%M:%S"</span>),</span>
<span id="cb61-215"><a href="#cb61-215" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_last_edited_by</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">_last_edited_by</span><span class="st">`</span>),</span>
<span id="cb61-216"><a href="#cb61-216" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_last_edited_date</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.POSIXct</span>(<span class="st">`</span><span class="at">_last_edited_date</span><span class="st">`</span>, <span class="at">format=</span><span class="st">"%Y-%m-%dT%H:%M:%S"</span>),</span>
<span id="cb61-217"><a href="#cb61-217" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_date_added</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.POSIXct</span>(<span class="st">`</span><span class="at">_date_added</span><span class="st">`</span>, <span class="at">format=</span><span class="st">"%Y-%m-%dT%H:%M:%S"</span>),</span>
<span id="cb61-218"><a href="#cb61-218" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_raw_source</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">_raw_source</span><span class="st">`</span>),</span>
<span id="cb61-219"><a href="#cb61-219" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">_algorithm</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">_algorithm</span><span class="st">`</span>)</span>
<span id="cb61-220"><a href="#cb61-220" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb61-221"><a href="#cb61-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-222"><a href="#cb61-222" aria-hidden="true" tabindex="-1"></a><span class="co"># Print cleaned data for inspection</span></span>
<span id="cb61-223"><a href="#cb61-223" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(cleaned_nodes)</span>
<span id="cb61-224"><a href="#cb61-224" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(cleaned_links)</span>
<span id="cb61-225"><a href="#cb61-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-226"><a href="#cb61-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-227"><a href="#cb61-227" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-228"><a href="#cb61-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-229"><a href="#cb61-229" aria-hidden="true" tabindex="-1"></a><span class="fu">### **Changing field name**</span></span>
<span id="cb61-230"><a href="#cb61-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-233"><a href="#cb61-233" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-234"><a href="#cb61-234" aria-hidden="true" tabindex="-1"></a>cleaned_nodes <span class="ot">&lt;-</span> cleaned_nodes <span class="sc">%&gt;%</span></span>
<span id="cb61-235"><a href="#cb61-235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"last_edited_by"</span> <span class="ot">=</span> <span class="st">"_last_edited_by"</span>,</span>
<span id="cb61-236"><a href="#cb61-236" aria-hidden="true" tabindex="-1"></a>         <span class="st">"date_added"</span> <span class="ot">=</span> <span class="st">"_date_added"</span>,</span>
<span id="cb61-237"><a href="#cb61-237" aria-hidden="true" tabindex="-1"></a>         <span class="st">"last_edited_date"</span> <span class="ot">=</span> <span class="st">"_last_edited_date"</span>,</span>
<span id="cb61-238"><a href="#cb61-238" aria-hidden="true" tabindex="-1"></a>         <span class="st">"raw_source"</span> <span class="ot">=</span> <span class="st">"_raw_source"</span>,</span>
<span id="cb61-239"><a href="#cb61-239" aria-hidden="true" tabindex="-1"></a>         <span class="st">"algorithm"</span> <span class="ot">=</span> <span class="st">"_algorithm"</span>) </span>
<span id="cb61-240"><a href="#cb61-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-241"><a href="#cb61-241" aria-hidden="true" tabindex="-1"></a>cleaned_links<span class="ot">&lt;-</span> cleaned_links <span class="sc">%&gt;%</span></span>
<span id="cb61-242"><a href="#cb61-242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"last_edited_by"</span> <span class="ot">=</span> <span class="st">"_last_edited_by"</span>,</span>
<span id="cb61-243"><a href="#cb61-243" aria-hidden="true" tabindex="-1"></a>         <span class="st">"date_added"</span> <span class="ot">=</span> <span class="st">"_date_added"</span>,</span>
<span id="cb61-244"><a href="#cb61-244" aria-hidden="true" tabindex="-1"></a>         <span class="st">"last_edited_date"</span> <span class="ot">=</span> <span class="st">"_last_edited_date"</span>,</span>
<span id="cb61-245"><a href="#cb61-245" aria-hidden="true" tabindex="-1"></a>         <span class="st">"raw_source"</span> <span class="ot">=</span> <span class="st">"_raw_source"</span>,</span>
<span id="cb61-246"><a href="#cb61-246" aria-hidden="true" tabindex="-1"></a>         <span class="st">"algorithm"</span> <span class="ot">=</span> <span class="st">"_algorithm"</span>) </span>
<span id="cb61-247"><a href="#cb61-247" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-248"><a href="#cb61-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-249"><a href="#cb61-249" aria-hidden="true" tabindex="-1"></a><span class="fu">### Split *'type'* column into separate columns</span></span>
<span id="cb61-250"><a href="#cb61-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-251"><a href="#cb61-251" aria-hidden="true" tabindex="-1"></a>We are going to tidy the type column by creating two columns "entity2,entity3".</span>
<span id="cb61-252"><a href="#cb61-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-255"><a href="#cb61-255" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-256"><a href="#cb61-256" aria-hidden="true" tabindex="-1"></a>word_list1 <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(cleaned_nodes<span class="sc">$</span>type, <span class="st">"</span><span class="sc">\\</span><span class="st">."</span>)</span>
<span id="cb61-257"><a href="#cb61-257" aria-hidden="true" tabindex="-1"></a>max_elements1 <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">lengths</span>(word_list1))</span>
<span id="cb61-258"><a href="#cb61-258" aria-hidden="true" tabindex="-1"></a>word_list_padded1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(word_list1, </span>
<span id="cb61-259"><a href="#cb61-259" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span>(x) <span class="fu">c</span>(x, <span class="fu">rep</span>(<span class="cn">NA</span>, max_elements1 <span class="sc">-</span> <span class="fu">length</span>(x))))</span>
<span id="cb61-260"><a href="#cb61-260" aria-hidden="true" tabindex="-1"></a>word_df1 <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, word_list_padded1)</span>
<span id="cb61-261"><a href="#cb61-261" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(word_df1) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"entity"</span>, <span class="dv">1</span><span class="sc">:</span>max_elements1)</span>
<span id="cb61-262"><a href="#cb61-262" aria-hidden="true" tabindex="-1"></a>word_df1 <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(word_df1) <span class="sc">%&gt;%</span></span>
<span id="cb61-263"><a href="#cb61-263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(entity2, entity3)</span>
<span id="cb61-264"><a href="#cb61-264" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(word_df1)</span>
<span id="cb61-265"><a href="#cb61-265" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-266"><a href="#cb61-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-267"><a href="#cb61-267" aria-hidden="true" tabindex="-1"></a>The steps below will be used to split text in type column into two columns</span>
<span id="cb61-268"><a href="#cb61-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-271"><a href="#cb61-271" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-272"><a href="#cb61-272" aria-hidden="true" tabindex="-1"></a>word_list <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(cleaned_links<span class="sc">$</span>type, <span class="st">"</span><span class="sc">\\</span><span class="st">."</span>)</span>
<span id="cb61-273"><a href="#cb61-273" aria-hidden="true" tabindex="-1"></a>max_elements <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">lengths</span>(word_list))</span>
<span id="cb61-274"><a href="#cb61-274" aria-hidden="true" tabindex="-1"></a>word_list_padded <span class="ot">&lt;-</span> <span class="fu">lapply</span>(word_list, </span>
<span id="cb61-275"><a href="#cb61-275" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span>(x) <span class="fu">c</span>(x, <span class="fu">rep</span>(<span class="cn">NA</span>, max_elements <span class="sc">-</span> <span class="fu">length</span>(x))))</span>
<span id="cb61-276"><a href="#cb61-276" aria-hidden="true" tabindex="-1"></a>word_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, word_list_padded)</span>
<span id="cb61-277"><a href="#cb61-277" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(word_df) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"event"</span>, <span class="dv">1</span><span class="sc">:</span>max_elements)</span>
<span id="cb61-278"><a href="#cb61-278" aria-hidden="true" tabindex="-1"></a>word_df <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(word_df) <span class="sc">%&gt;%</span></span>
<span id="cb61-279"><a href="#cb61-279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(event2, event3)</span>
<span id="cb61-280"><a href="#cb61-280" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(word_df)</span>
<span id="cb61-281"><a href="#cb61-281" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-282"><a href="#cb61-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-283"><a href="#cb61-283" aria-hidden="true" tabindex="-1"></a>Since the output above is a matrix, the code chunk above is used to convert word_df into a tibble data.frame.</span>
<span id="cb61-284"><a href="#cb61-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-287"><a href="#cb61-287" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-288"><a href="#cb61-288" aria-hidden="true" tabindex="-1"></a>cleaned_nodes <span class="ot">&lt;-</span> cleaned_nodes <span class="sc">%&gt;%</span></span>
<span id="cb61-289"><a href="#cb61-289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(word_df1)</span>
<span id="cb61-290"><a href="#cb61-290" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-291"><a href="#cb61-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-294"><a href="#cb61-294" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-295"><a href="#cb61-295" aria-hidden="true" tabindex="-1"></a>cleaned_links <span class="ot">&lt;-</span> cleaned_links <span class="sc">%&gt;%</span></span>
<span id="cb61-296"><a href="#cb61-296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(word_df)</span>
<span id="cb61-297"><a href="#cb61-297" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-298"><a href="#cb61-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-299"><a href="#cb61-299" aria-hidden="true" tabindex="-1"></a>The code chunk above appends the extracted columns back to edges tibble data.frame.</span>
<span id="cb61-300"><a href="#cb61-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-303"><a href="#cb61-303" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-304"><a href="#cb61-304" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cleaned_nodes, <span class="st">"data/rds/cleaned_nodes.rds"</span>)</span>
<span id="cb61-305"><a href="#cb61-305" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cleaned_links, <span class="st">"data/rds/cleaned_links.rds"</span>)</span>
<span id="cb61-306"><a href="#cb61-306" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-307"><a href="#cb61-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-308"><a href="#cb61-308" aria-hidden="true" tabindex="-1"></a>above code write into R&nbsp;**rds**&nbsp;file format.</span>
<span id="cb61-309"><a href="#cb61-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-310"><a href="#cb61-310" aria-hidden="true" tabindex="-1"></a><span class="fu">## Question 3</span></span>
<span id="cb61-311"><a href="#cb61-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-312"><a href="#cb61-312" aria-hidden="true" tabindex="-1"></a>By analyzing the ownership structure, we tracked changes in most influential individuals (VIP) networks over time, identifying key individuals with increasing influence.</span>
<span id="cb61-313"><a href="#cb61-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-314"><a href="#cb61-314" aria-hidden="true" tabindex="-1"></a><span class="fu">### Part 1: Data Wrangling </span></span>
<span id="cb61-315"><a href="#cb61-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-316"><a href="#cb61-316" aria-hidden="true" tabindex="-1"></a>Split the nodes into people and companies, and filter ownership-related edges</span>
<span id="cb61-317"><a href="#cb61-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-320"><a href="#cb61-320" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-321"><a href="#cb61-321" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the nodes into people and companies</span></span>
<span id="cb61-322"><a href="#cb61-322" aria-hidden="true" tabindex="-1"></a>nodes_people <span class="ot">&lt;-</span> cleaned_nodes <span class="sc">%&gt;%</span> <span class="fu">filter</span>(entity2 <span class="sc">==</span> <span class="st">"Person"</span>)</span>
<span id="cb61-323"><a href="#cb61-323" aria-hidden="true" tabindex="-1"></a>nodes_company <span class="ot">&lt;-</span> cleaned_nodes <span class="sc">%&gt;%</span> <span class="fu">filter</span>(entity2 <span class="sc">==</span> <span class="st">"Organization"</span>)</span>
<span id="cb61-324"><a href="#cb61-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-325"><a href="#cb61-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-326"><a href="#cb61-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-327"><a href="#cb61-327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-328"><a href="#cb61-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-331"><a href="#cb61-331" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-332"><a href="#cb61-332" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the links to include only ownership-related edges</span></span>
<span id="cb61-333"><a href="#cb61-333" aria-hidden="true" tabindex="-1"></a>links_owns <span class="ot">&lt;-</span> cleaned_links <span class="sc">%&gt;%</span> <span class="fu">filter</span>(event2 <span class="sc">==</span> <span class="st">"Owns"</span>)</span>
<span id="cb61-334"><a href="#cb61-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-335"><a href="#cb61-335" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-336"><a href="#cb61-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-339"><a href="#cb61-339" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-340"><a href="#cb61-340" aria-hidden="true" tabindex="-1"></a>nodes_people <span class="ot">&lt;-</span> nodes_people <span class="sc">%&gt;%</span></span>
<span id="cb61-341"><a href="#cb61-341" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb61-342"><a href="#cb61-342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">'no_owns'</span> <span class="ot">=</span> <span class="fu">sum</span>(links_owns<span class="sc">$</span>source <span class="sc">==</span> id))</span>
<span id="cb61-343"><a href="#cb61-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-344"><a href="#cb61-344" aria-hidden="true" tabindex="-1"></a>nodes_people<span class="sc">$</span>no_owns <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(nodes_people<span class="sc">$</span>no_owns)</span>
<span id="cb61-345"><a href="#cb61-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-346"><a href="#cb61-346" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-347"><a href="#cb61-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-350"><a href="#cb61-350" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-351"><a href="#cb61-351" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the unique counts of 'no_owns' and their corresponding counts and percentages</span></span>
<span id="cb61-352"><a href="#cb61-352" aria-hidden="true" tabindex="-1"></a>owns_summary <span class="ot">&lt;-</span> nodes_people <span class="sc">%&gt;%</span></span>
<span id="cb61-353"><a href="#cb61-353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(no_owns) <span class="sc">%&gt;%</span></span>
<span id="cb61-354"><a href="#cb61-354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb61-355"><a href="#cb61-355" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> (count <span class="sc">/</span> <span class="fu">sum</span>(count)) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb61-356"><a href="#cb61-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-357"><a href="#cb61-357" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the summary</span></span>
<span id="cb61-358"><a href="#cb61-358" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(owns_summary)</span>
<span id="cb61-359"><a href="#cb61-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-360"><a href="#cb61-360" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-361"><a href="#cb61-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-362"><a href="#cb61-362" aria-hidden="true" tabindex="-1"></a>To define and identify influential people based on an ownership threshold. It filters the nodes to keep only those with a significant number of ownerships</span>
<span id="cb61-363"><a href="#cb61-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-366"><a href="#cb61-366" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-367"><a href="#cb61-367" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the threshold for 'influential'</span></span>
<span id="cb61-368"><a href="#cb61-368" aria-hidden="true" tabindex="-1"></a>vip_threshold <span class="ot">&lt;-</span> <span class="dv">91</span></span>
<span id="cb61-369"><a href="#cb61-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-370"><a href="#cb61-370" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to keep only influential people and select relevant columns</span></span>
<span id="cb61-371"><a href="#cb61-371" aria-hidden="true" tabindex="-1"></a>vip <span class="ot">&lt;-</span> nodes_people <span class="sc">%&gt;%</span></span>
<span id="cb61-372"><a href="#cb61-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(no_owns <span class="sc">&gt;=</span> vip_threshold) <span class="sc">%&gt;%</span></span>
<span id="cb61-373"><a href="#cb61-373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, country, dob, last_edited_date, date_added, no_owns)</span>
<span id="cb61-374"><a href="#cb61-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-375"><a href="#cb61-375" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the updated vip data frame</span></span>
<span id="cb61-376"><a href="#cb61-376" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(vip)</span>
<span id="cb61-377"><a href="#cb61-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-378"><a href="#cb61-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-379"><a href="#cb61-379" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-380"><a href="#cb61-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-381"><a href="#cb61-381" aria-hidden="true" tabindex="-1"></a>filter the ownership connections to include only those involving these influential individuals</span>
<span id="cb61-382"><a href="#cb61-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-385"><a href="#cb61-385" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-386"><a href="#cb61-386" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter links_owns to keep only those connections where the source is in the vip list</span></span>
<span id="cb61-387"><a href="#cb61-387" aria-hidden="true" tabindex="-1"></a>vip_connections <span class="ot">&lt;-</span> links_owns <span class="sc">%&gt;%</span></span>
<span id="cb61-388"><a href="#cb61-388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source <span class="sc">%in%</span> vip<span class="sc">$</span>id)<span class="sc">%&gt;%</span></span>
<span id="cb61-389"><a href="#cb61-389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source, target,start_date,end_date,last_edited_date, date_added)</span>
<span id="cb61-390"><a href="#cb61-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-391"><a href="#cb61-391" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the updated vip_connections data frame</span></span>
<span id="cb61-392"><a href="#cb61-392" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(vip_connections)</span>
<span id="cb61-393"><a href="#cb61-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-394"><a href="#cb61-394" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-395"><a href="#cb61-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-396"><a href="#cb61-396" aria-hidden="true" tabindex="-1"></a><span class="fu">### Part 1: Network Graph </span></span>
<span id="cb61-397"><a href="#cb61-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-398"><a href="#cb61-398" aria-hidden="true" tabindex="-1"></a>Finally, plot the network, highlighting the structure and connections of influential individuals.</span>
<span id="cb61-399"><a href="#cb61-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-402"><a href="#cb61-402" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-403"><a href="#cb61-403" aria-hidden="true" tabindex="-1"></a><span class="co"># Create graph from VIP connections</span></span>
<span id="cb61-404"><a href="#cb61-404" aria-hidden="true" tabindex="-1"></a>g_vip <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> vip_connections, <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb61-405"><a href="#cb61-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-406"><a href="#cb61-406" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify VIPs and Companies</span></span>
<span id="cb61-407"><a href="#cb61-407" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g_vip)<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g_vip)<span class="sc">$</span>name <span class="sc">%in%</span> nodes_people<span class="sc">$</span>id, <span class="st">"VIP"</span>, <span class="st">"Company"</span>)</span>
<span id="cb61-408"><a href="#cb61-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-409"><a href="#cb61-409" aria-hidden="true" tabindex="-1"></a><span class="co"># Define colors and sizes</span></span>
<span id="cb61-410"><a href="#cb61-410" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g_vip)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g_vip)<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"VIP"</span>, <span class="st">"blue"</span>, <span class="st">"orange"</span>)</span>
<span id="cb61-411"><a href="#cb61-411" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g_vip)<span class="sc">$</span>size <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g_vip)<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"VIP"</span>, <span class="dv">8</span>, <span class="dv">5</span>)</span>
<span id="cb61-412"><a href="#cb61-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-413"><a href="#cb61-413" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the network</span></span>
<span id="cb61-414"><a href="#cb61-414" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g_vip, <span class="at">vertex.label =</span> <span class="cn">NA</span>, <span class="at">vertex.size =</span> <span class="fu">V</span>(g_vip)<span class="sc">$</span>size, <span class="at">edge.arrow.size =</span> <span class="fl">0.5</span>, </span>
<span id="cb61-415"><a href="#cb61-415" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.color =</span> <span class="fu">V</span>(g_vip)<span class="sc">$</span>color, <span class="at">main =</span> <span class="st">"VIP Connections Network"</span>)</span>
<span id="cb61-416"><a href="#cb61-416" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-417"><a href="#cb61-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-418"><a href="#cb61-418" aria-hidden="true" tabindex="-1"></a>The plot represents the VIP Connections Network, with blue nodes indicating influential VIPs and orange nodes representing companies they own. Directed edges illustrate ownership, pointing from VIPs to companies. This visualization highlights the dense centrality of VIPs, showcasing their extensive control across multiple companies. By examining these connections, we can infer the structure and extent of VIP influence within the network and help FishEye identify influential individuals within the business network, highlighting ownership structures and central figures. By tracking ownership changes over time, FishEye can pinpoint who controls companies involved in illegal fishing activities.</span>
<span id="cb61-419"><a href="#cb61-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-420"><a href="#cb61-420" aria-hidden="true" tabindex="-1"></a>While this plot provides a static snapshot, in the following we shall create similar plots for different time periods can reveal changes in ownership and influence over time.</span>
<span id="cb61-421"><a href="#cb61-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-422"><a href="#cb61-422" aria-hidden="true" tabindex="-1"></a><span class="fu">### Part 2: Temporal Analysis </span></span>
<span id="cb61-423"><a href="#cb61-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-424"><a href="#cb61-424" aria-hidden="true" tabindex="-1"></a>Aggregate Ownership Changes by Year</span>
<span id="cb61-425"><a href="#cb61-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-428"><a href="#cb61-428" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-429"><a href="#cb61-429" aria-hidden="true" tabindex="-1"></a>change_over_time1 <span class="ot">&lt;-</span> links_owns <span class="sc">%&gt;%</span></span>
<span id="cb61-430"><a href="#cb61-430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(start_date) <span class="sc">%&gt;%</span></span>
<span id="cb61-431"><a href="#cb61-431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb61-432"><a href="#cb61-432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb61-433"><a href="#cb61-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-434"><a href="#cb61-434" aria-hidden="true" tabindex="-1"></a>links_owns<span class="ot">&lt;-</span> links_owns <span class="sc">%&gt;%</span></span>
<span id="cb61-435"><a href="#cb61-435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_year =</span> <span class="fu">format</span>(start_date, <span class="st">"%Y"</span>))</span>
<span id="cb61-436"><a href="#cb61-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-437"><a href="#cb61-437" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate ownership changes by year</span></span>
<span id="cb61-438"><a href="#cb61-438" aria-hidden="true" tabindex="-1"></a>change_over_time <span class="ot">&lt;-</span> links_owns <span class="sc">%&gt;%</span></span>
<span id="cb61-439"><a href="#cb61-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(start_year) <span class="sc">%&gt;%</span></span>
<span id="cb61-440"><a href="#cb61-440" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb61-441"><a href="#cb61-441" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb61-442"><a href="#cb61-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-443"><a href="#cb61-443" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-444"><a href="#cb61-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-445"><a href="#cb61-445" aria-hidden="true" tabindex="-1"></a>Create plots to visualize the changes in ownership over time.</span>
<span id="cb61-446"><a href="#cb61-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-449"><a href="#cb61-449" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-450"><a href="#cb61-450" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot changes over time</span></span>
<span id="cb61-451"><a href="#cb61-451" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(change_over_time, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(start_year), <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb61-452"><a href="#cb61-452" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb61-453"><a href="#cb61-453" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb61-454"><a href="#cb61-454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Changes in Ownership Over Time"</span>,</span>
<span id="cb61-455"><a href="#cb61-455" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb61-456"><a href="#cb61-456" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Ownership Changes"</span>) <span class="sc">+</span></span>
<span id="cb61-457"><a href="#cb61-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb61-458"><a href="#cb61-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-459"><a href="#cb61-459" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-460"><a href="#cb61-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-461"><a href="#cb61-461" aria-hidden="true" tabindex="-1"></a><span class="fu">### Part 2: Network Graph by Year</span></span>
<span id="cb61-462"><a href="#cb61-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-463"><a href="#cb61-463" aria-hidden="true" tabindex="-1"></a>Given the significant increase in data from 2004 onwards, focusing on every 10 years from 2005 to 2035 would provide a more detailed analysis of changes in ownership and influence.</span>
<span id="cb61-464"><a href="#cb61-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-467"><a href="#cb61-467" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-468"><a href="#cb61-468" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the year </span></span>
<span id="cb61-469"><a href="#cb61-469" aria-hidden="true" tabindex="-1"></a>filter_year <span class="ot">&lt;-</span> <span class="dv">2005</span></span>
<span id="cb61-470"><a href="#cb61-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-471"><a href="#cb61-471" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter vip_connections by start_year</span></span>
<span id="cb61-472"><a href="#cb61-472" aria-hidden="true" tabindex="-1"></a>vip_connections_filtered <span class="ot">&lt;-</span> vip_connections <span class="sc">%&gt;%</span></span>
<span id="cb61-473"><a href="#cb61-473" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">format</span>(start_date, <span class="st">"%Y"</span>) <span class="sc">==</span> filter_year)</span>
<span id="cb61-474"><a href="#cb61-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-475"><a href="#cb61-475" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the graph object from the filtered vip_connections</span></span>
<span id="cb61-476"><a href="#cb61-476" aria-hidden="true" tabindex="-1"></a>g_vip_filtered <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> vip_connections_filtered, <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb61-477"><a href="#cb61-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-478"><a href="#cb61-478" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify VIPs (nodes_people) and Companies</span></span>
<span id="cb61-479"><a href="#cb61-479" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g_vip_filtered)<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g_vip_filtered)<span class="sc">$</span>name <span class="sc">%in%</span> nodes_people<span class="sc">$</span>id, <span class="st">"VIP"</span>, <span class="st">"Company"</span>)</span>
<span id="cb61-480"><a href="#cb61-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-481"><a href="#cb61-481" aria-hidden="true" tabindex="-1"></a><span class="co"># Define colors and sizes</span></span>
<span id="cb61-482"><a href="#cb61-482" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g_vip_filtered)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g_vip_filtered)<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"VIP"</span>, <span class="st">"blue"</span>, <span class="st">"orange"</span>)</span>
<span id="cb61-483"><a href="#cb61-483" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g_vip_filtered)<span class="sc">$</span>size <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g_vip_filtered)<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"VIP"</span>, <span class="dv">8</span>, <span class="dv">5</span>)</span>
<span id="cb61-484"><a href="#cb61-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-485"><a href="#cb61-485" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the network</span></span>
<span id="cb61-486"><a href="#cb61-486" aria-hidden="true" tabindex="-1"></a>p2005<span class="ot">&lt;-</span><span class="fu">plot</span>(g_vip_filtered, <span class="at">vertex.label =</span> <span class="cn">NA</span>, <span class="at">vertex.size =</span> <span class="fu">V</span>(g_vip_filtered)<span class="sc">$</span>size, <span class="at">edge.arrow.size =</span> <span class="fl">0.5</span>, </span>
<span id="cb61-487"><a href="#cb61-487" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.color =</span> <span class="fu">V</span>(g_vip_filtered)<span class="sc">$</span>color, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"VIP Connections Network for"</span>, filter_year))</span>
<span id="cb61-488"><a href="#cb61-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-489"><a href="#cb61-489" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-490"><a href="#cb61-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-491"><a href="#cb61-491" aria-hidden="true" tabindex="-1"></a>In 2005, the network shows a relatively sparse structure with a moderate number of connections. VIPs (blue nodes) are moderately interconnected, indicating a balanced distribution of influence among several key players.</span>
<span id="cb61-492"><a href="#cb61-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-495"><a href="#cb61-495" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-496"><a href="#cb61-496" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the year</span></span>
<span id="cb61-497"><a href="#cb61-497" aria-hidden="true" tabindex="-1"></a>filter_year <span class="ot">&lt;-</span> <span class="dv">2015</span></span>
<span id="cb61-498"><a href="#cb61-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-499"><a href="#cb61-499" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter vip_connections by start_year</span></span>
<span id="cb61-500"><a href="#cb61-500" aria-hidden="true" tabindex="-1"></a>vip_connections_filtered_2015 <span class="ot">&lt;-</span> vip_connections <span class="sc">%&gt;%</span></span>
<span id="cb61-501"><a href="#cb61-501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">format</span>(start_date, <span class="st">"%Y"</span>) <span class="sc">==</span> filter_year)</span>
<span id="cb61-502"><a href="#cb61-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-503"><a href="#cb61-503" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the graph object from the filtered vip_connections</span></span>
<span id="cb61-504"><a href="#cb61-504" aria-hidden="true" tabindex="-1"></a>g_vip_filtered_2015 <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> vip_connections_filtered_2015, <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb61-505"><a href="#cb61-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-506"><a href="#cb61-506" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify VIPs (nodes_people) and Companies</span></span>
<span id="cb61-507"><a href="#cb61-507" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g_vip_filtered_2015)<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g_vip_filtered_2015)<span class="sc">$</span>name <span class="sc">%in%</span> nodes_people<span class="sc">$</span>id, <span class="st">"VIP"</span>, <span class="st">"Company"</span>)</span>
<span id="cb61-508"><a href="#cb61-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-509"><a href="#cb61-509" aria-hidden="true" tabindex="-1"></a><span class="co"># Define colors and sizes</span></span>
<span id="cb61-510"><a href="#cb61-510" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g_vip_filtered_2015)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g_vip_filtered_2015)<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"VIP"</span>, <span class="st">"blue"</span>, <span class="st">"orange"</span>)</span>
<span id="cb61-511"><a href="#cb61-511" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g_vip_filtered_2015)<span class="sc">$</span>size <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g_vip_filtered_2015)<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"VIP"</span>, <span class="dv">8</span>, <span class="dv">5</span>)</span>
<span id="cb61-512"><a href="#cb61-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-513"><a href="#cb61-513" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the network</span></span>
<span id="cb61-514"><a href="#cb61-514" aria-hidden="true" tabindex="-1"></a>p2015 <span class="ot">&lt;-</span> <span class="fu">plot</span>(g_vip_filtered_2015, <span class="at">vertex.label =</span> <span class="cn">NA</span>, <span class="at">vertex.size =</span> <span class="fu">V</span>(g_vip_filtered_2015)<span class="sc">$</span>size, <span class="at">edge.arrow.size =</span> <span class="fl">0.5</span>, </span>
<span id="cb61-515"><a href="#cb61-515" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.color =</span> <span class="fu">V</span>(g_vip_filtered_2015)<span class="sc">$</span>color, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"VIP Connections Network for"</span>, filter_year))</span>
<span id="cb61-516"><a href="#cb61-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-517"><a href="#cb61-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-518"><a href="#cb61-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-519"><a href="#cb61-519" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-520"><a href="#cb61-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-521"><a href="#cb61-521" aria-hidden="true" tabindex="-1"></a>By 2015, the network has grown denser, suggesting increased interconnectedness and influence consolidation. More VIPs are connected to multiple companies (orange nodes), indicating a significant rise in their influence and control over the network.</span>
<span id="cb61-522"><a href="#cb61-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-525"><a href="#cb61-525" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-526"><a href="#cb61-526" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the year</span></span>
<span id="cb61-527"><a href="#cb61-527" aria-hidden="true" tabindex="-1"></a>filter_year <span class="ot">&lt;-</span> <span class="dv">2025</span></span>
<span id="cb61-528"><a href="#cb61-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-529"><a href="#cb61-529" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter vip_connections by start_year</span></span>
<span id="cb61-530"><a href="#cb61-530" aria-hidden="true" tabindex="-1"></a>vip_connections_filtered_2025 <span class="ot">&lt;-</span> vip_connections <span class="sc">%&gt;%</span></span>
<span id="cb61-531"><a href="#cb61-531" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">format</span>(start_date, <span class="st">"%Y"</span>) <span class="sc">==</span> filter_year)</span>
<span id="cb61-532"><a href="#cb61-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-533"><a href="#cb61-533" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the graph object from the filtered vip_connections</span></span>
<span id="cb61-534"><a href="#cb61-534" aria-hidden="true" tabindex="-1"></a>g_vip_filtered_2025 <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> vip_connections_filtered_2025, <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb61-535"><a href="#cb61-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-536"><a href="#cb61-536" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify VIPs (nodes_people) and Companies</span></span>
<span id="cb61-537"><a href="#cb61-537" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g_vip_filtered_2025)<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g_vip_filtered_2025)<span class="sc">$</span>name <span class="sc">%in%</span> nodes_people<span class="sc">$</span>id, <span class="st">"VIP"</span>, <span class="st">"Company"</span>)</span>
<span id="cb61-538"><a href="#cb61-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-539"><a href="#cb61-539" aria-hidden="true" tabindex="-1"></a><span class="co"># Define colors and sizes</span></span>
<span id="cb61-540"><a href="#cb61-540" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g_vip_filtered_2025)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g_vip_filtered_2025)<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"VIP"</span>, <span class="st">"blue"</span>, <span class="st">"orange"</span>)</span>
<span id="cb61-541"><a href="#cb61-541" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g_vip_filtered_2025)<span class="sc">$</span>size <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g_vip_filtered_2025)<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"VIP"</span>, <span class="dv">8</span>, <span class="dv">5</span>)</span>
<span id="cb61-542"><a href="#cb61-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-543"><a href="#cb61-543" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the network</span></span>
<span id="cb61-544"><a href="#cb61-544" aria-hidden="true" tabindex="-1"></a>p2025 <span class="ot">&lt;-</span> <span class="fu">plot</span>(g_vip_filtered_2025, <span class="at">vertex.label =</span> <span class="cn">NA</span>, <span class="at">vertex.size =</span> <span class="fu">V</span>(g_vip_filtered_2025)<span class="sc">$</span>size, <span class="at">edge.arrow.size =</span> <span class="fl">0.5</span>, </span>
<span id="cb61-545"><a href="#cb61-545" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.color =</span> <span class="fu">V</span>(g_vip_filtered_2025)<span class="sc">$</span>color, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"VIP Connections Network for"</span>, filter_year))</span>
<span id="cb61-546"><a href="#cb61-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-547"><a href="#cb61-547" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-548"><a href="#cb61-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-549"><a href="#cb61-549" aria-hidden="true" tabindex="-1"></a>The network continues to expand in 2025, displaying even more complexity and interconnections. This period likely represents a peak in influence for several VIPs, with many of them owning shares in numerous companies, suggesting increased market control.</span>
<span id="cb61-550"><a href="#cb61-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-553"><a href="#cb61-553" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-554"><a href="#cb61-554" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the year</span></span>
<span id="cb61-555"><a href="#cb61-555" aria-hidden="true" tabindex="-1"></a>filter_year <span class="ot">&lt;-</span> <span class="dv">2035</span></span>
<span id="cb61-556"><a href="#cb61-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-557"><a href="#cb61-557" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter vip_connections by start_year</span></span>
<span id="cb61-558"><a href="#cb61-558" aria-hidden="true" tabindex="-1"></a>vip_connections_filtered_2035 <span class="ot">&lt;-</span> vip_connections <span class="sc">%&gt;%</span></span>
<span id="cb61-559"><a href="#cb61-559" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">format</span>(start_date, <span class="st">"%Y"</span>) <span class="sc">==</span> filter_year)</span>
<span id="cb61-560"><a href="#cb61-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-561"><a href="#cb61-561" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the graph object from the filtered vip_connections</span></span>
<span id="cb61-562"><a href="#cb61-562" aria-hidden="true" tabindex="-1"></a>g_vip_filtered_2035 <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> vip_connections_filtered_2035, <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb61-563"><a href="#cb61-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-564"><a href="#cb61-564" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify VIPs (nodes_people) and Companies</span></span>
<span id="cb61-565"><a href="#cb61-565" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g_vip_filtered_2035)<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g_vip_filtered_2035)<span class="sc">$</span>name <span class="sc">%in%</span> nodes_people<span class="sc">$</span>id, <span class="st">"VIP"</span>, <span class="st">"Company"</span>)</span>
<span id="cb61-566"><a href="#cb61-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-567"><a href="#cb61-567" aria-hidden="true" tabindex="-1"></a><span class="co"># Define colors and sizes</span></span>
<span id="cb61-568"><a href="#cb61-568" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g_vip_filtered_2035)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g_vip_filtered_2035)<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"VIP"</span>, <span class="st">"blue"</span>, <span class="st">"orange"</span>)</span>
<span id="cb61-569"><a href="#cb61-569" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g_vip_filtered_2035)<span class="sc">$</span>size <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g_vip_filtered_2035)<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"VIP"</span>, <span class="dv">8</span>, <span class="dv">5</span>)</span>
<span id="cb61-570"><a href="#cb61-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-571"><a href="#cb61-571" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the network</span></span>
<span id="cb61-572"><a href="#cb61-572" aria-hidden="true" tabindex="-1"></a>p2035 <span class="ot">&lt;-</span> <span class="fu">plot</span>(g_vip_filtered_2035, <span class="at">vertex.label =</span> <span class="cn">NA</span>, <span class="at">vertex.size =</span> <span class="fu">V</span>(g_vip_filtered_2035)<span class="sc">$</span>size, <span class="at">edge.arrow.size =</span> <span class="fl">0.5</span>, </span>
<span id="cb61-573"><a href="#cb61-573" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.color =</span> <span class="fu">V</span>(g_vip_filtered_2035)<span class="sc">$</span>color, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"VIP Connections Network for"</span>, filter_year))</span>
<span id="cb61-574"><a href="#cb61-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-575"><a href="#cb61-575" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-576"><a href="#cb61-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-577"><a href="#cb61-577" aria-hidden="true" tabindex="-1"></a>In 2035, the network structure shifts to a star-like formation, where a central VIP appears to have gained substantial influence, with direct connections to numerous companies. This indicates a significant consolidation of power and influence, where a few key players dominate the network.</span>
<span id="cb61-578"><a href="#cb61-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-579"><a href="#cb61-579" aria-hidden="true" tabindex="-1"></a>::: callout-caution</span>
<span id="cb61-580"><a href="#cb61-580" aria-hidden="true" tabindex="-1"></a>Initially, influence is distributed among several key players, but over the years, it becomes concentrated among fewer individuals, leading to a highly centralized network by 2035. This centralization of power can be both an opportunity for streamlined decision-making and a risk for monopolistic control. Monitoring these changes is crucial for regulatory bodies like FishEye to ensure fair practices and prevent illegal activities within the network.</span>
<span id="cb61-581"><a href="#cb61-581" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb61-582"><a href="#cb61-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-583"><a href="#cb61-583" aria-hidden="true" tabindex="-1"></a><span class="fu">## Question 4</span></span>
<span id="cb61-584"><a href="#cb61-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-585"><a href="#cb61-585" aria-hidden="true" tabindex="-1"></a>For part 1, the focus was on identifying the network associated with SouthSeafood Express Corp and visualizing how this network and competing businesses changed as a result of their illegal fishing behavior.</span>
<span id="cb61-586"><a href="#cb61-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-587"><a href="#cb61-587" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Part 1: Identify SouthSeafood Express Corp Node</span></span>
<span id="cb61-588"><a href="#cb61-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-589"><a href="#cb61-589" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Locate the node representing SouthSeafood Express Corp in the network.</span>
<span id="cb61-590"><a href="#cb61-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-591"><a href="#cb61-591" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Create a visualization of the network associated with SouthSeafood Express Corp before any changes.</span>
<span id="cb61-592"><a href="#cb61-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-595"><a href="#cb61-595" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-596"><a href="#cb61-596" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract edges connected to SouthSeafood Express Corp</span></span>
<span id="cb61-597"><a href="#cb61-597" aria-hidden="true" tabindex="-1"></a>southseafood_edges <span class="ot">&lt;-</span> cleaned_links <span class="sc">%&gt;%</span></span>
<span id="cb61-598"><a href="#cb61-598" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source <span class="sc">==</span> <span class="st">"SouthSeafood Express Corp"</span> <span class="sc">|</span> target <span class="sc">==</span> <span class="st">"SouthSeafood Express Corp"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb61-599"><a href="#cb61-599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source,target,start_date,end_date,event2)</span>
<span id="cb61-600"><a href="#cb61-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-601"><a href="#cb61-601" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure all nodes in the edge list are present in the vertex data frame</span></span>
<span id="cb61-602"><a href="#cb61-602" aria-hidden="true" tabindex="-1"></a>southseafood_nodes <span class="ot">&lt;-</span> cleaned_nodes <span class="sc">%&gt;%</span></span>
<span id="cb61-603"><a href="#cb61-603" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">%in%</span> (<span class="fu">c</span>(southseafood_edges<span class="sc">$</span>source, southseafood_edges<span class="sc">$</span>target)))</span>
<span id="cb61-604"><a href="#cb61-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-605"><a href="#cb61-605" aria-hidden="true" tabindex="-1"></a><span class="co"># Join edges with nodes to ensure all nodes are present</span></span>
<span id="cb61-606"><a href="#cb61-606" aria-hidden="true" tabindex="-1"></a>southseafood_edges <span class="ot">&lt;-</span> southseafood_edges <span class="sc">%&gt;%</span></span>
<span id="cb61-607"><a href="#cb61-607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source <span class="sc">%in%</span> southseafood_nodes<span class="sc">$</span>id <span class="sc">&amp;</span> target <span class="sc">%in%</span> southseafood_nodes<span class="sc">$</span>id)</span>
<span id="cb61-608"><a href="#cb61-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-609"><a href="#cb61-609" aria-hidden="true" tabindex="-1"></a><span class="co"># Create graph object for the sub-network</span></span>
<span id="cb61-610"><a href="#cb61-610" aria-hidden="true" tabindex="-1"></a>g_southseafood <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> southseafood_edges, <span class="at">vertices =</span> southseafood_nodes, <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb61-611"><a href="#cb61-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-612"><a href="#cb61-612" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the initial network</span></span>
<span id="cb61-613"><a href="#cb61-613" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g_southseafood, <span class="at">vertex.label =</span> <span class="cn">NA</span>, <span class="at">vertex.size =</span> <span class="dv">5</span>, <span class="at">edge.arrow.size =</span> <span class="fl">0.5</span>, </span>
<span id="cb61-614"><a href="#cb61-614" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.color =</span> <span class="st">"orange"</span>, <span class="at">main =</span> <span class="st">"Network Associated with SouthSeafood Express Corp"</span>)</span>
<span id="cb61-615"><a href="#cb61-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-616"><a href="#cb61-616" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-617"><a href="#cb61-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-618"><a href="#cb61-618" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Part 1: Identify Competing Businesses</span></span>
<span id="cb61-619"><a href="#cb61-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-620"><a href="#cb61-620" aria-hidden="true" tabindex="-1"></a>Identify and highlight competing businesses within the extracted sub-network.</span>
<span id="cb61-621"><a href="#cb61-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-624"><a href="#cb61-624" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-625"><a href="#cb61-625" aria-hidden="true" tabindex="-1"></a>competing_businesses <span class="ot">&lt;-</span> cleaned_nodes <span class="sc">%&gt;%</span></span>
<span id="cb61-626"><a href="#cb61-626" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(entity3 <span class="sc">==</span> <span class="st">"FishingCompany"</span> <span class="sc">&amp;</span> id <span class="sc">!=</span> <span class="st">"SouthSeafood Express Corp"</span>)</span>
<span id="cb61-627"><a href="#cb61-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-628"><a href="#cb61-628" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-629"><a href="#cb61-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-632"><a href="#cb61-632" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-633"><a href="#cb61-633" aria-hidden="true" tabindex="-1"></a>competing_edges <span class="ot">&lt;-</span> cleaned_links <span class="sc">%&gt;%</span></span>
<span id="cb61-634"><a href="#cb61-634" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source <span class="sc">%in%</span> competing_businesses<span class="sc">$</span>id <span class="sc">|</span> target <span class="sc">%in%</span> competing_businesses<span class="sc">$</span>id) <span class="sc">%&gt;%</span></span>
<span id="cb61-635"><a href="#cb61-635" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source, target, start_date, end_date, event2)</span>
<span id="cb61-636"><a href="#cb61-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-637"><a href="#cb61-637" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine SouthSeafood Express Corp edges with competing businesses edges</span></span>
<span id="cb61-638"><a href="#cb61-638" aria-hidden="true" tabindex="-1"></a>combined_edges <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(southseafood_edges, competing_edges)</span>
<span id="cb61-639"><a href="#cb61-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-640"><a href="#cb61-640" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the combined set of nodes</span></span>
<span id="cb61-641"><a href="#cb61-641" aria-hidden="true" tabindex="-1"></a>combined_nodes <span class="ot">&lt;-</span> cleaned_nodes <span class="sc">%&gt;%</span></span>
<span id="cb61-642"><a href="#cb61-642" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">%in%</span> <span class="fu">c</span>(combined_edges<span class="sc">$</span>source, combined_edges<span class="sc">$</span>target))</span>
<span id="cb61-643"><a href="#cb61-643" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-644"><a href="#cb61-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-647"><a href="#cb61-647" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-648"><a href="#cb61-648" aria-hidden="true" tabindex="-1"></a><span class="co"># Create graph object for the combined network</span></span>
<span id="cb61-649"><a href="#cb61-649" aria-hidden="true" tabindex="-1"></a>g_combined <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> combined_edges, <span class="at">vertices =</span> combined_nodes, <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb61-650"><a href="#cb61-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-651"><a href="#cb61-651" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-652"><a href="#cb61-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-653"><a href="#cb61-653" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Part 1: Analyze Temporal Changes based on *start_year*</span></span>
<span id="cb61-654"><a href="#cb61-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-655"><a href="#cb61-655" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Filter the data to show the network before and after the illegal fishing incident(assume the incident happened in 2023)</span>
<span id="cb61-656"><a href="#cb61-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-657"><a href="#cb61-657" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Create visualizations to compare the network structure and connections before and after the incident.</span>
<span id="cb61-658"><a href="#cb61-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-661"><a href="#cb61-661" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-662"><a href="#cb61-662" aria-hidden="true" tabindex="-1"></a><span class="co"># Assume the accident happened in 2023</span></span>
<span id="cb61-663"><a href="#cb61-663" aria-hidden="true" tabindex="-1"></a>incident_year <span class="ot">&lt;-</span> <span class="dv">2023</span></span>
<span id="cb61-664"><a href="#cb61-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-665"><a href="#cb61-665" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter edges before the incident</span></span>
<span id="cb61-666"><a href="#cb61-666" aria-hidden="true" tabindex="-1"></a>edges_before <span class="ot">&lt;-</span> combined_edges <span class="sc">%&gt;%</span></span>
<span id="cb61-667"><a href="#cb61-667" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">format</span>(start_date, <span class="st">"%Y"</span>) <span class="sc">&lt;</span> incident_year)</span>
<span id="cb61-668"><a href="#cb61-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-669"><a href="#cb61-669" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter edges after the incident</span></span>
<span id="cb61-670"><a href="#cb61-670" aria-hidden="true" tabindex="-1"></a>edges_after <span class="ot">&lt;-</span> combined_edges <span class="sc">%&gt;%</span></span>
<span id="cb61-671"><a href="#cb61-671" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">format</span>(start_date, <span class="st">"%Y"</span>) <span class="sc">&gt;=</span> incident_year)</span>
<span id="cb61-672"><a href="#cb61-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-673"><a href="#cb61-673" aria-hidden="true" tabindex="-1"></a><span class="co"># Create graph objects for before and after the incident</span></span>
<span id="cb61-674"><a href="#cb61-674" aria-hidden="true" tabindex="-1"></a>g_before <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> edges_before, <span class="at">vertices =</span> combined_nodes, <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb61-675"><a href="#cb61-675" aria-hidden="true" tabindex="-1"></a>g_after <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> edges_after, <span class="at">vertices =</span> combined_nodes, <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb61-676"><a href="#cb61-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-677"><a href="#cb61-677" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-678"><a href="#cb61-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-679"><a href="#cb61-679" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Part 1: Visualize the Temporal Changes</span></span>
<span id="cb61-680"><a href="#cb61-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-681"><a href="#cb61-681" aria-hidden="true" tabindex="-1"></a>Identify and highlight significant changes in connections and structure due to the illegal fishing behavior and subsequent closure.</span>
<span id="cb61-682"><a href="#cb61-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-685"><a href="#cb61-685" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-686"><a href="#cb61-686" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb61-687"><a href="#cb61-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-688"><a href="#cb61-688" aria-hidden="true" tabindex="-1"></a>plot_before <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(g_before, <span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span></span>
<span id="cb61-689"><a href="#cb61-689" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">edge_alpha =</span> <span class="fl">0.8</span>), <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb61-690"><a href="#cb61-690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">ifelse</span>(name <span class="sc">==</span> <span class="st">"SouthSeafood Express Corp"</span>, <span class="st">"SouthSeafood"</span>, </span>
<span id="cb61-691"><a href="#cb61-691" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">ifelse</span>(type <span class="sc">==</span> <span class="st">"Entity.Organization.FishingCompany"</span>, <span class="st">"FishingCompany"</span>, <span class="st">"Other"</span>))), </span>
<span id="cb61-692"><a href="#cb61-692" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="co"># Adjusted alpha for transparency</span></span>
<span id="cb61-693"><a href="#cb61-693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"SouthSeafood"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"FishingCompany"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Other"</span> <span class="ot">=</span> <span class="st">"orange"</span>),</span>
<span id="cb61-694"><a href="#cb61-694" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="st">"Type"</span>) <span class="sc">+</span> <span class="co"># Shortened legend title</span></span>
<span id="cb61-695"><a href="#cb61-695" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb61-696"><a href="#cb61-696" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb61-697"><a href="#cb61-697" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Network Before Incident"</span>)</span>
<span id="cb61-698"><a href="#cb61-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-699"><a href="#cb61-699" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot for the network before the incident</span></span>
<span id="cb61-700"><a href="#cb61-700" aria-hidden="true" tabindex="-1"></a>plot_before</span>
<span id="cb61-701"><a href="#cb61-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-702"><a href="#cb61-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-703"><a href="#cb61-703" aria-hidden="true" tabindex="-1"></a>plot_after <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(g_after, <span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span></span>
<span id="cb61-704"><a href="#cb61-704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">edge_alpha =</span> <span class="fl">0.8</span>), <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb61-705"><a href="#cb61-705" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">ifelse</span>(name <span class="sc">==</span> <span class="st">"SouthSeafood Express Corp"</span>, <span class="st">"SouthSeafood"</span>, </span>
<span id="cb61-706"><a href="#cb61-706" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">ifelse</span>(type <span class="sc">==</span> <span class="st">"Entity.Organization.FishingCompany"</span>, <span class="st">"FishingCompany"</span>, <span class="st">"Other"</span>))), </span>
<span id="cb61-707"><a href="#cb61-707" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="co"># Adjusted alpha for transparency</span></span>
<span id="cb61-708"><a href="#cb61-708" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"SouthSeafood"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"FishingCompany"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Other"</span> <span class="ot">=</span> <span class="st">"orange"</span>),</span>
<span id="cb61-709"><a href="#cb61-709" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="st">"Type"</span>) <span class="sc">+</span> <span class="co"># Shortened legend title</span></span>
<span id="cb61-710"><a href="#cb61-710" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb61-711"><a href="#cb61-711" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb61-712"><a href="#cb61-712" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Network After Incident"</span>)</span>
<span id="cb61-713"><a href="#cb61-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-714"><a href="#cb61-714" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot for the network after the incident</span></span>
<span id="cb61-715"><a href="#cb61-715" aria-hidden="true" tabindex="-1"></a>plot_after</span>
<span id="cb61-716"><a href="#cb61-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-717"><a href="#cb61-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-718"><a href="#cb61-718" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-719"><a href="#cb61-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-720"><a href="#cb61-720" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb61-721"><a href="#cb61-721" aria-hidden="true" tabindex="-1"></a>**Observations**:</span>
<span id="cb61-722"><a href="#cb61-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-723"><a href="#cb61-723" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The number of blue nodes (fishing companies) appears to have decreased.</span>
<span id="cb61-724"><a href="#cb61-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-725"><a href="#cb61-725" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>SouthSeafood Express Corp (red node) remains central but its connections might have changed, indicating possible impact from the incident.</span>
<span id="cb61-726"><a href="#cb61-726" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb61-727"><a href="#cb61-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-728"><a href="#cb61-728" aria-hidden="true" tabindex="-1"></a>For part 2, since we cannot use revenue data over time, we will focus on identifying which companies potentially benefited from SouthSeafood Express Corp's legal troubles by analyzing changes in network centrality measures.</span>
<span id="cb61-729"><a href="#cb61-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-730"><a href="#cb61-730" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Part 2: Calculate Centrality Measures Before and After the Incident</span></span>
<span id="cb61-731"><a href="#cb61-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-734"><a href="#cb61-734" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-735"><a href="#cb61-735" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate degree centrality before the incident</span></span>
<span id="cb61-736"><a href="#cb61-736" aria-hidden="true" tabindex="-1"></a>degree_before <span class="ot">&lt;-</span> <span class="fu">degree</span>(g_before, <span class="at">mode =</span> <span class="st">"all"</span>)</span>
<span id="cb61-737"><a href="#cb61-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-738"><a href="#cb61-738" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate degree centrality after the incident</span></span>
<span id="cb61-739"><a href="#cb61-739" aria-hidden="true" tabindex="-1"></a>degree_after <span class="ot">&lt;-</span> <span class="fu">degree</span>(g_after, <span class="at">mode =</span> <span class="st">"all"</span>)</span>
<span id="cb61-740"><a href="#cb61-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-741"><a href="#cb61-741" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine degree centrality measures into a data frame</span></span>
<span id="cb61-742"><a href="#cb61-742" aria-hidden="true" tabindex="-1"></a>centrality_change <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb61-743"><a href="#cb61-743" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="fu">names</span>(degree_before),</span>
<span id="cb61-744"><a href="#cb61-744" aria-hidden="true" tabindex="-1"></a>  <span class="at">degree_before =</span> degree_before,</span>
<span id="cb61-745"><a href="#cb61-745" aria-hidden="true" tabindex="-1"></a>  <span class="at">degree_after =</span> degree_after</span>
<span id="cb61-746"><a href="#cb61-746" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb61-747"><a href="#cb61-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-748"><a href="#cb61-748" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the change in degree centrality</span></span>
<span id="cb61-749"><a href="#cb61-749" aria-hidden="true" tabindex="-1"></a>centrality_change <span class="ot">&lt;-</span> centrality_change <span class="sc">%&gt;%</span></span>
<span id="cb61-750"><a href="#cb61-750" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">change =</span> degree_after <span class="sc">-</span> degree_before)</span>
<span id="cb61-751"><a href="#cb61-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-752"><a href="#cb61-752" aria-hidden="true" tabindex="-1"></a><span class="co"># Display companies with the most positive change in degree centrality</span></span>
<span id="cb61-753"><a href="#cb61-753" aria-hidden="true" tabindex="-1"></a>top_beneficiaries <span class="ot">&lt;-</span> centrality_change <span class="sc">%&gt;%</span></span>
<span id="cb61-754"><a href="#cb61-754" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(change)) <span class="sc">%&gt;%</span></span>
<span id="cb61-755"><a href="#cb61-755" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb61-756"><a href="#cb61-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-757"><a href="#cb61-757" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(top_beneficiaries)</span>
<span id="cb61-758"><a href="#cb61-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-759"><a href="#cb61-759" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-760"><a href="#cb61-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-761"><a href="#cb61-761" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Part 2: Determine Entity Type</span></span>
<span id="cb61-762"><a href="#cb61-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-765"><a href="#cb61-765" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-766"><a href="#cb61-766" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge with cleaned_nodes to get the entity type</span></span>
<span id="cb61-767"><a href="#cb61-767" aria-hidden="true" tabindex="-1"></a>top_beneficiaries_info <span class="ot">&lt;-</span> top_beneficiaries <span class="sc">%&gt;%</span></span>
<span id="cb61-768"><a href="#cb61-768" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(cleaned_nodes, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb61-769"><a href="#cb61-769" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, change,entity3)</span>
<span id="cb61-770"><a href="#cb61-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-771"><a href="#cb61-771" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the entity type of top beneficiaries</span></span>
<span id="cb61-772"><a href="#cb61-772" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(top_beneficiaries_info)</span>
<span id="cb61-773"><a href="#cb61-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-774"><a href="#cb61-774" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-775"><a href="#cb61-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-776"><a href="#cb61-776" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Part 2: Visualize the Changes </span></span>
<span id="cb61-777"><a href="#cb61-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-780"><a href="#cb61-780" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-781"><a href="#cb61-781" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot of top beneficiaries</span></span>
<span id="cb61-782"><a href="#cb61-782" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top_beneficiaries_info, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(id, change), <span class="at">y =</span> change)) <span class="sc">+</span></span>
<span id="cb61-783"><a href="#cb61-783" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb61-784"><a href="#cb61-784" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb61-785"><a href="#cb61-785" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb61-786"><a href="#cb61-786" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top Beneficiaries by Change in Degree Centrality"</span>,</span>
<span id="cb61-787"><a href="#cb61-787" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Company"</span>,</span>
<span id="cb61-788"><a href="#cb61-788" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Change in Degree Centrality"</span>,</span>
<span id="cb61-789"><a href="#cb61-789" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Entity Type"</span>) <span class="sc">+</span></span>
<span id="cb61-790"><a href="#cb61-790" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb61-791"><a href="#cb61-791" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-792"><a href="#cb61-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-793"><a href="#cb61-793" aria-hidden="true" tabindex="-1"></a>The results show that the top beneficiaries, all classified as fishing companies, significantly increased their network centrality following SouthSeafood Express Corp's legal troubles. Anderson-Roberts, Hall, Hartman and Hall, and Kirk Inc., among others, saw the largest gains, suggesting they capitalized on the shift in the network's structure.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>